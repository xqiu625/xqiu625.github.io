<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cross-Species Data Integration - AI4Bio Learning Hub</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Lato', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #D0D6D8 100%);
            line-height: 1.8;
            color: #333;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .navbar {
            background-color: #ffffff;
            border-bottom: 1px solid #e7e7e7;
            padding: 10px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .navbar-nav {
            list-style-type: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }
        .navbar-nav li {
            margin: 0 15px;
        }
        .navbar-nav a {
            color: #666666;
            text-decoration: none;
            font-weight: bold;
            font-size: 15px;
            transition: color 0.3s ease;
        }
        .navbar-nav a:hover {
            color: #48B09E;
        }
        .home-link {
            color: #48B09E !important;
        }
        .header {
            background: linear-gradient(135deg, #189177 0%, #48B09E 100%);
            color: white;
            padding: 50px 40px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
            box-shadow: 0 4px 20px rgba(24, 145, 119, 0.3);
        }
        .header h1 {
            margin: 0 0 15px 0;
            font-size: 2.8em;
            font-weight: 700;
        }
        .header .subtitle {
            font-size: 1.3em;
            margin-bottom: 25px;
            opacity: 0.95;
        }
        .paper-ref {
            background: rgba(255,255,255,0.2);
            padding: 20px;
            border-radius: 10px;
            margin-top: 25px;
            font-size: 1em;
            border: 1px solid rgba(255,255,255,0.3);
        }
        .content-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        .content-section h2 {
            color: #189177;
            font-size: 2em;
            margin-bottom: 25px;
            border-left: 4px solid #48B09E;
            padding-left: 15px;
        }
        .content-section h3 {
            color: #0D8A85;
            font-size: 1.5em;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        .content-section p {
            color: #555;
            line-height: 1.9;
            margin-bottom: 15px;
        }
        .concept-box {
            background: linear-gradient(135deg, #f0faf8 0%, #e6f7f4 100%);
            border-left: 5px solid #189177;
            padding: 25px;
            margin: 25px 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(24, 145, 119, 0.15);
        }
        .concept-box h3 {
            color: #189177;
            margin-top: 0;
        }
        .concept-box.challenge {
            border-left-color: #e74c3c;
            background: linear-gradient(135deg, #fdf2f2 0%, #fce4e4 100%);
        }
        .concept-box.challenge h3 {
            color: #e74c3c;
        }
        .concept-box.method1 {
            border-left-color: #3498db;
            background: linear-gradient(135deg, #f0f7fc 0%, #e3f2fd 100%);
        }
        .concept-box.method1 h3 {
            color: #3498db;
        }
        .concept-box.method2 {
            border-left-color: #f39c12;
            background: linear-gradient(135deg, #fef9f0 0%, #fdf5e6 100%);
        }
        .concept-box.method2 h3 {
            color: #f39c12;
        }
        .concept-box.method3 {
            border-left-color: #9b59b6;
            background: linear-gradient(135deg, #f7f3f9 0%, #f3e5f5 100%);
        }
        .concept-box.method3 h3 {
            color: #9b59b6;
        }
        .highlight-box {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border: 2px solid #28a745;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .highlight-box strong {
            color: #155724;
        }
        .warning-box {
            background: linear-gradient(135deg, #fff3cd 0%, #ffe8a1 100%);
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .warning-box strong {
            color: #856404;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-radius: 10px;
            overflow: hidden;
        }
        .comparison-table th,
        .comparison-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        .comparison-table th {
            background: linear-gradient(135deg, #189177 0%, #48B09E 100%);
            color: white;
            font-weight: 600;
        }
        .comparison-table tr:hover {
            background: rgba(24, 145, 119, 0.05);
        }
        .comparison-table tr:last-child td {
            border-bottom: none;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #189177 0%, #48B09E 100%);
            color: white;
            padding: 30px 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(24, 145, 119, 0.3);
            transition: transform 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
        }
        .stat-card .number {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .stat-card .label {
            font-size: 1em;
            opacity: 0.95;
            line-height: 1.4;
        }
        .timeline {
            position: relative;
            padding: 30px 0;
            margin: 40px 0;
        }
        .timeline::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, #189177 0%, #48B09E 100%);
        }
        .timeline-item {
            position: relative;
            padding-left: 70px;
            margin-bottom: 40px;
        }
        .timeline-icon {
            position: absolute;
            left: 0;
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #189177 0%, #48B09E 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2em;
            box-shadow: 0 3px 10px rgba(24, 145, 119, 0.4);
        }
        .timeline-content {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #189177;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .timeline-content h4 {
            color: #189177;
            margin-top: 0;
            font-size: 1.2em;
        }
        .species-divergence {
            display: flex;
            align-items: center;
            justify-content: space-around;
            margin: 35px 0;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
        }
        .species-box {
            text-align: center;
            padding: 20px;
        }
        .species-icon {
            font-size: 3.5em;
            margin-bottom: 15px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }
        .divergence-arrow {
            font-size: 2.5em;
            color: #189177;
            font-weight: 700;
        }
        .divergence-arrow small {
            display: block;
            font-size: 0.4em;
            color: #999;
            font-weight: 400;
            margin: 5px 0;
        }
        .method-card {
            background: white;
            border: 3px solid #189177;
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(24, 145, 119, 0.2);
        }
        .method-card h4 {
            color: #189177;
            margin-top: 0;
            font-size: 1.4em;
        }
        .pros-cons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 25px 0;
        }
        .pros, .cons {
            padding: 20px;
            border-radius: 10px;
        }
        .pros {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-left: 5px solid #28a745;
        }
        .pros h4 {
            color: #155724;
            margin-top: 0;
        }
        .cons {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border-left: 5px solid #dc3545;
        }
        .cons h4 {
            color: #721c24;
            margin-top: 0;
        }
        .decision-tree {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
            margin: 25px 0;
            border: 2px solid #189177;
        }
        .decision-node {
            background: white;
            border: 2px solid #189177;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .decision-node strong {
            color: #189177;
            font-size: 1.1em;
        }
        .decision-arrow {
            text-align: center;
            color: #48B09E;
            font-size: 2em;
            margin: 15px 0;
            font-weight: 700;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 25px;
            border-radius: 10px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            line-height: 1.6;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .code-block .comment {
            color: #75715e;
        }
        .code-block .keyword {
            color: #f92672;
        }
        .code-block .string {
            color: #e6db74;
        }
        .cta-section {
            background: linear-gradient(135deg, #189177 0%, #48B09E 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            margin: 40px 0;
            text-align: center;
            box-shadow: 0 4px 20px rgba(24, 145, 119, 0.3);
        }
        .cta-section h3 {
            color: white;
            margin-bottom: 15px;
        }
        .cta-button {
            display: inline-block;
            background: white;
            color: #189177;
            padding: 12px 30px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 700;
            margin: 10px;
            transition: all 0.3s ease;
        }
        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            .header {
                padding: 30px 25px;
            }
            .content-section {
                padding: 25px;
            }
            .pros-cons {
                grid-template-columns: 1fr;
            }
            .species-divergence {
                flex-direction: column;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
            .navbar-nav li {
                margin: 5px 10px;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <ul class="navbar-nav">
                <li><a href="../index.html" class="home-link"><i class="fas fa-home"></i> Back to Learning Hub</a></li>
                <li><a href="#challenge">Challenge</a></li>
                <li><a href="#strategies">Strategies</a></li>
                <li><a href="#methods">Methods</a></li>
                <li><a href="#decision">Decision Guide</a></li>
            </ul>
        </div>
    </nav>

    <main role="main">
        <div class="container">
            <div class="header">
                <h1><i class="fas fa-project-diagram"></i> Cross-Species Data Integration</h1>
                <p class="subtitle">Strategies for integrating genomics data across evolutionarily distant species</p>
                <div class="paper-ref">
                    <strong>🔬 Key Example:</strong> SATURN (Rosen et al. 2024) integrates frog ↔ zebrafish (350M years divergence) and human ↔ mouse ↔ lemur atlases using protein language models
                </div>
            </div>

            <!-- The Challenge -->
            <div class="content-section" id="challenge">
                <h2><i class="fas fa-exclamation-triangle"></i> The Challenge</h2>
                
                <div class="concept-box challenge">
                    <h3>Why Cross-Species Integration Is Hard</h3>
                    <p><strong>Core Problem:</strong> Different species have different genes. A gene present in Species A may not exist in Species B, or may have diverged so much that traditional matching methods fail.</p>
                </div>

                <h3>Evolutionary Timeline Examples</h3>
                <div class="species-divergence">
                    <div class="species-box">
                        <div class="species-icon">🐸</div>
                        <strong>Frog</strong><br>
                        <small>~20,000 genes</small>
                    </div>
                    <div class="divergence-arrow">
                        ←<br>
                        <small>350 million years</small><br>
                        →
                    </div>
                    <div class="species-box">
                        <div class="species-icon">🐠</div>
                        <strong>Zebrafish</strong><br>
                        <small>~26,000 genes</small>
                    </div>
                </div>

                <div class="species-divergence">
                    <div class="species-box">
                        <div class="species-icon">👤</div>
                        <strong>Human</strong><br>
                        <small>~25,000 genes</small>
                    </div>
                    <div class="divergence-arrow">
                        ←<br>
                        <small>90 million years</small><br>
                        →
                    </div>
                    <div class="species-box">
                        <div class="species-icon">🐭</div>
                        <strong>Mouse</strong><br>
                        <small>~22,000 genes</small>
                    </div>
                </div>

                <h3>What Happens to Genes Over Time</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="number">1:1</div>
                        <div class="label">Orthologs (conserved genes)</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">1:Many</div>
                        <div class="label">Paralogs (duplications)</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">Lost</div>
                        <div class="label">Gene loss events</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">Novel</div>
                        <div class="label">Lineage-specific genes</div>
                    </div>
                </div>

                <div class="warning-box">
                    <strong><i class="fas fa-exclamation-circle"></i> The Homolog Problem:</strong> 
                    Human-Mouse share ~17,000 1:1 orthologs out of ~25,000 human genes (68%). Human-Mouse-Lemur (3 species) might only have ~12,000 shared orthologs (48%). As you add more species, the common gene set shrinks dramatically.
                </div>
            </div>

            <!-- Three Approaches -->
            <div class="content-section" id="strategies">
                <h2><i class="fas fa-sitemap"></i> Three Integration Strategies</h2>
                
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-icon">1</div>
                        <div class="timeline-content">
                            <h4>One-to-One Homolog Subsetting (2010s)</h4>
                            <p>Restrict analysis to genes with clear 1:1 orthologs across all species</p>
                            <p><strong>Used by:</strong> Harmony, scVI, Scanorama, most batch correction methods</p>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-icon">2</div>
                        <div class="timeline-content">
                            <h4>Sequence Alignment Graphs (2020-2021)</h4>
                            <p>Build weighted gene graphs using BLASTP sequence similarity</p>
                            <p><strong>Used by:</strong> SAMap (Tarashansky et al. 2021)</p>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-icon">3</div>
                        <div class="timeline-content">
                            <h4>Functional Embeddings (2024+)</h4>
                            <p>Represent genes by protein function using language models</p>
                            <p><strong>Used by:</strong> SATURN (Rosen et al. 2024)</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Method 1: One-to-One Homologs -->
            <div class="content-section" id="methods">
                <h2><i class="fas fa-layer-group"></i> Method 1: One-to-One Homolog Subsetting</h2>
                
                <div class="concept-box method1">
                    <h3>Core Idea</h3>
                    <p>Only use genes that have a single clear ortholog in every species being integrated. Query databases like ENSEMBL or NCBI HomoloGene to find these 1:1 relationships.</p>
                </div>

                <h3>How It Works</h3>
                <div class="concept-box">
                    <p>Query databases like ENSEMBL or NCBI HomoloGene to identify genes with 1:1 ortholog relationships. Filter your expression data to include only these shared orthologs across all species in your analysis. This approach works with any standard batch correction method like Harmony, scVI, or Scanorama.</p>
                </div>

                <div class="pros-cons">
                    <div class="pros">
                        <h4><i class="fas fa-check-circle"></i> Advantages</h4>
                        <ul>
                            <li>Simple and straightforward</li>
                            <li>Biologically interpretable</li>
                            <li>Works with any batch correction method</li>
                            <li>High confidence in gene matches</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h4><i class="fas fa-times-circle"></i> Limitations</h4>
                        <ul>
                            <li><strong>Massive gene loss:</strong> 50-80% of genes discarded</li>
                            <li>Excludes lineage-specific genes</li>
                            <li>Ignores many-to-many relationships (paralogs)</li>
                            <li>Worse with more species (intersection shrinks)</li>
                        </ul>
                    </div>
                </div>

                <h3>Performance Benchmark: SATURN Study</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Uses 1:1 Homologs?</th>
                            <th>Genes Used</th>
                            <th>Accuracy (Zebrafish→Frog)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Harmony</strong></td>
                            <td>Yes</td>
                            <td>~8,000 shared orthologs</td>
                            <td>32.5%</td>
                        </tr>
                        <tr>
                            <td><strong>scVI</strong></td>
                            <td>Yes</td>
                            <td>~8,000 shared orthologs</td>
                            <td>30.1%</td>
                        </tr>
                        <tr>
                            <td><strong>Scanorama</strong></td>
                            <td>Yes</td>
                            <td>~8,000 shared orthologs</td>
                            <td>11.2%</td>
                        </tr>
                        <tr style="background: rgba(24, 145, 119, 0.1);">
                            <td><strong>SATURN</strong></td>
                            <td><strong>No (all genes)</strong></td>
                            <td><strong>~46,000 total genes</strong></td>
                            <td><strong>85.8%</strong></td>
                        </tr>
                    </tbody>
                </table>

                <div class="warning-box">
                    <strong><i class="fas fa-exclamation-triangle"></i> Key Limitation:</strong> 
                    Frog has ~20,000 genes, zebrafish ~26,000 genes. Using only 1:1 orthologs means discarding 82% of frog genes and 69% of zebrafish genes!
                </div>
            </div>

            <!-- Method 2: Sequence Alignment -->
            <div class="content-section">
                <h2><i class="fas fa-align-center"></i> Method 2: Sequence Alignment Graphs</h2>
                
                <div class="concept-box method2">
                    <h3>Core Idea</h3>
                    <p>Build a weighted graph where genes are nodes and edges represent sequence similarity from BLASTP. Genes don't need 1:1 relationships—any gene with sufficient similarity can be connected.</p>
                </div>

                <h3>How SAMap Works</h3>
                <ol>
                    <li><strong>Run BLASTP:</strong> All-vs-all protein sequence alignment across species</li>
                    <li><strong>Build Gene Graph:</strong> Create edges with weights = BLAST bit score / max possible score</li>
                    <li><strong>Graph Neural Network:</strong> Learn gene embeddings that incorporate cross-species edges</li>
                    <li><strong>Integrate Cells:</strong> Map cells using gene embeddings + expression</li>
                </ol>

                <div class="pros-cons">
                    <div class="pros">
                        <h4><i class="fas fa-check-circle"></i> Advantages</h4>
                        <ul>
                            <li>Handles many-to-many relationships (paralogs)</li>
                            <li>Uses more genes than 1:1 method</li>
                            <li>Weighted edges capture confidence</li>
                            <li>Can include genes without perfect matches</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h4><i class="fas fa-times-circle"></i> Limitations</h4>
                        <ul>
                            <li><strong>Threshold-dependent:</strong> Need arbitrary e-value cutoff</li>
                            <li><strong>Poor for remote species:</strong> Fails at <30% sequence identity</li>
                            <li><strong>Misses remote homology:</strong> Functional similarity without sequence similarity</li>
                            <li>Only 39.2% accuracy on frog-zebrafish</li>
                        </ul>
                    </div>
                </div>

                <h3>Why Sequence Alignment Fails for Distant Species</h3>
                <div class="concept-box">
                    <p><strong>Example: Claudin genes in frog and zebrafish ionocytes</strong></p>
                    <ul>
                        <li><strong>Biological reality:</strong> Claudins are known markers of gill ionocytes in zebrafish</li>
                        <li><strong>BLASTP results:</strong> Frog and zebrafish claudins don't meet significance threshold (e-value > 1e-5)</li>
                        <li><strong>Consequence:</strong> SAMap cannot match these functionally related genes</li>
                        <li><strong>SATURN solution:</strong> ESM2 embeddings group claudins together despite <30% sequence identity</li>
                    </ul>
                </div>
            </div>

            <!-- Method 3: Functional Embeddings -->
            <div class="content-section">
                <h2><i class="fas fa-brain"></i> Method 3: Functional Embeddings (Protein Language Models)</h2>
                
                <div class="concept-box method3">
                    <h3>Core Idea</h3>
                    <p>Don't match genes by sequence—represent them by <strong>what they do</strong>. Use protein language models (like ESM2) trained on 250M proteins to create functional embeddings that capture similarity even without sequence conservation.</p>
                </div>

                <h3>How SATURN Works</h3>
                <ol>
                    <li><strong>Generate Protein Embeddings:</strong> Pass all proteins through ESM2 → 5120-dim vectors</li>
                    <li><strong>Create Macrogenes:</strong> Cluster embeddings → groups of functionally related genes</li>
                    <li><strong>Learn Weights:</strong> Gene-to-macrogene weights based on embedding similarity</li>
                    <li><strong>Integrate:</strong> All species share the macrogene space (no gene matching needed!)</li>
                </ol>

                <div class="highlight-box">
                    <strong><i class="fas fa-lightbulb"></i> Key Innovation:</strong> 
                    Instead of asking "Does frog gene X match zebrafish gene Y?", ask "What biological functions do these genes perform?" Genes with similar functions (e.g., DNA repair, ion transport) cluster together even if their sequences have diverged.
                </div>

                <div class="pros-cons">
                    <div class="pros">
                        <h4><i class="fas fa-check-circle"></i> Advantages</h4>
                        <ul>
                            <li><strong>Uses ALL genes</strong> from all species (no subsetting!)</li>
                            <li>Captures remote homology (<30% sequence identity)</li>
                            <li>Finds functionally related non-homologs</li>
                            <li>Interpretable (macrogenes = gene modules)</li>
                            <li>Scales to many species (no intersection shrinkage)</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h4><i class="fas fa-times-circle"></i> Limitations</h4>
                        <ul>
                            <li>Requires high-quality reference proteomes</li>
                            <li>Computationally expensive (ESM2 = 80GB GPU memory)</li>
                            <li>Cannot represent non-coding RNAs</li>
                            <li>Less mature than homolog-based methods</li>
                        </ul>
                    </div>
                </div>

                <h3>Performance Comparison</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="number">85.8%</div>
                        <div class="label">SATURN (Functional)</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">39.2%</div>
                        <div class="label">SAMap (Sequence)</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">32.5%</div>
                        <div class="label">Harmony (1:1 Homologs)</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">119%</div>
                        <div class="label">Improvement over best baseline</div>
                    </div>
                </div>
            </div>

            <!-- Decision Tree -->
            <div class="content-section" id="decision">
                <h2><i class="fas fa-code-branch"></i> Which Method Should You Use?</h2>
                
                <div class="decision-tree">
                    <div class="decision-node">
                        <strong>Q: How evolutionarily distant are your species?</strong>
                    </div>
                    <div class="decision-arrow">↓</div>
                    
                    <div class="decision-node">
                        <strong>Close (<100M years, e.g., Human-Mouse)</strong>
                        <ul>
                            <li>✅ <strong>Method 1 (1:1 Homologs)</strong> works well</li>
                            <li>~60-70% genes retained</li>
                            <li>Use with Harmony, scVI, Scanorama</li>
                            <li>Fast, simple, well-tested</li>
                        </ul>
                    </div>
                    
                    <div class="decision-node">
                        <strong>Moderate (100-250M years, e.g., Human-Chicken)</strong>
                        <ul>
                            <li>⚠️ <strong>Method 2 (Sequence Alignment)</strong> may work</li>
                            <li>~40-50% genes retained</li>
                            <li>Use SAMap with careful threshold tuning</li>
                            <li>Consider Method 3 if performance is poor</li>
                        </ul>
                    </div>
                    
                    <div class="decision-node">
                        <strong>Remote (>250M years, e.g., Frog-Zebrafish)</strong>
                        <ul>
                            <li>✅ <strong>Method 3 (Functional Embeddings)</strong> required</li>
                            <li>100% genes retained</li>
                            <li>Use SATURN or similar protein LM approach</li>
                            <li>Higher computational cost but much better performance</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Best Practices -->
            <div class="content-section">
                <h2><i class="fas fa-check-square"></i> Best Practices</h2>
                
                <h3>Before Integration</h3>
                <div class="concept-box">
                    <ol>
                        <li><strong>Check divergence time:</strong> Use TimeTree (timetree.org) to estimate species separation</li>
                        <li><strong>Assess homolog coverage:</strong> Query ENSEMBL/NCBI to see % genes with 1:1 orthologs</li>
                        <li><strong>Quality control individual datasets:</strong> Remove low-quality cells within each species first</li>
                        <li><strong>Normalize appropriately:</strong> Use library size normalization, log-transform</li>
                    </ol>
                </div>

                <h3>During Integration</h3>
                <div class="concept-box">
                    <ol>
                        <li><strong>Test multiple methods:</strong> Try all applicable approaches on a small test set</li>
                        <li><strong>Use cell type annotations:</strong> Weakly supervised methods (SAMap, SATURN) work better than unsupervised</li>
                        <li><strong>Validate biologically:</strong> Check if known marker genes align correctly</li>
                        <li><strong>Assess batch mixing vs. biology:</strong> Use SCIB metrics (batch integration + bio conservation)</li>
                    </ol>
                </div>

                <div class="warning-box">
                    <strong><i class="fas fa-exclamation-circle"></i> Common Pitfall:</strong> 
                    Don't just look at UMAP plots! Species mixing in 2D visualization doesn't guarantee correct cell type alignment. Always validate quantitatively with label transfer or marker gene analysis.
                </div>
            </div>

            <!-- CTA Section -->
            <div class="cta-section">
                <h3>📚 Continue Learning</h3>
                <p>Explore related concepts and deepen your understanding of AI4Bio methods</p>
                <a href="../index.html" class="cta-button">
                    <i class="fas fa-arrow-left"></i> Back to Learning Hub
                </a>
                <a href="../foundation-models/protein-language-models-gene-representation.html" class="cta-button">
                    Protein Language Models <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>
    </main>

    <footer>
        <div class="container" style="text-align: center; margin-top: 40px; padding: 30px; color: #666;">
            <p>Part of the <a href="../index.html" style="color: #189177; text-decoration: none; font-weight: bold;">AI4Bio Learning Hub</a> by Xinru Qiu</p>
            <p style="font-size: 0.9em; margin-top: 10px;">
                <a href="https://github.com/xqiu625" style="color: #666; margin: 0 10px;"><i class="fab fa-github"></i> GitHub</a> | 
                <a href="https://www.linkedin.com/in/xinru-qiu" style="color: #666; margin: 0 10px;"><i class="fab fa-linkedin"></i> LinkedIn</a> | 
                <a href="mailto:xinru.reina.qiu@gmail.com" style="color: #666; margin: 0 10px;"><i class="fas fa-envelope"></i> Email</a>
            </p>
            <p style="font-size: 0.9em; margin-top: 10px;">Last updated: January 2025</p>
        </div>
    </footer>
</body>
</html>
