<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Single-Cell Drug Response Prediction - AI4Bio Learning Hub</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Lato', sans-serif;
            background: linear-gradient(135deg, #f0f9e8 0%, #e8f5d8 100%);
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        .navbar {
            background-color: #ffffff;
            border-bottom: 1px solid #e7e7e7;
            padding: 10px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .navbar-nav {
            list-style-type: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }
        .navbar-nav li {
            margin: 5px 15px;
        }
        .navbar-nav a {
            color: #666666;
            text-decoration: none;
            font-weight: bold;
            font-size: 16px;
            transition: color 0.3s;
        }
        .navbar-nav a:hover {
            color: #8FC50E;
        }
        .home-link {
            color: #6b8e23 !important;
        }
        .header {
            text-align: center;
            margin: 40px 0 30px 0;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(143, 197, 14, 0.15);
        }
        .header h1 {
            color: #6b8e23;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .header .subtitle {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 20px;
        }
        .header .description {
            max-width: 900px;
            margin: 0 auto;
            font-size: 1em;
            color: #555;
            line-height: 1.8;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #8FC50E 0%, #A9D563 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }
        .stat-number {
            font-size: 3em;
            font-weight: bold;
            display: block;
        }
        .stat-label {
            font-size: 1em;
            opacity: 0.9;
        }
        .filter-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(143, 197, 14, 0.15);
        }
        .filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        .filter-btn {
            padding: 10px 20px;
            border: 2px solid #8FC50E;
            background: white;
            color: #6b8e23;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        .filter-btn:hover, .filter-btn.active {
            background: #8FC50E;
            color: white;
        }
        .timeline {
            position: relative;
            margin: 40px 0;
        }
        .timeline-year {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(143, 197, 14, 0.15);
        }
        .timeline-year h2 {
            color: #6b8e23;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-left: 5px solid #8FC50E;
            padding-left: 15px;
        }
        .method-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .method-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border-left: 5px solid;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .method-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        .method-card.transfer { border-left-color: #8FC50E; }
        .method-card.transformer { border-left-color: #A9D563; }
        .method-card.grn { border-left-color: #7ab800; }
        .method-card.heterogeneity { border-left-color: #9ed12e; }
        .method-card.database { border-left-color: #6b8e23; }
        .method-card.repurposing { border-left-color: #B8DF96; }
        
        .method-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }
        .method-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #6b8e23;
            margin: 0;
        }
        .method-badges {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: bold;
            color: white;
        }
        .badge-transfer { background: #8FC50E; }
        .badge-transformer { background: #A9D563; }
        .badge-grn { background: #7ab800; }
        .badge-heterogeneity { background: #9ed12e; }
        .badge-database { background: #6b8e23; }
        .badge-repurposing { background: #B8DF96; }
        .badge-year { background: #7f8c8d; }
        
        .method-journal {
            color: #666;
            font-size: 0.9em;
            font-style: italic;
            margin-bottom: 10px;
        }
        .method-description {
            color: #555;
            font-size: 0.95em;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        .method-links {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        .method-link {
            display: inline-block;
            padding: 6px 12px;
            background: #8FC50E;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-size: 0.85em;
            transition: all 0.3s;
        }
        .method-link:hover {
            background: #A9D563;
            transform: translateX(2px);
        }
        .algorithm-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px dashed #ddd;
            display: none;
        }
        .algorithm-section.show {
            display: block;
            animation: slideDown 0.3s ease;
        }
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .algorithm-title {
            color: #6b8e23;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .algorithm-steps {
            background: white;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.8;
        }
        .algorithm-steps ol {
            margin: 0;
            padding-left: 20px;
        }
        .algorithm-steps li {
            margin-bottom: 8px;
        }
        .algorithm-steps code {
            background: #f1f3f5;
            padding: 2px 6px;
            border-radius: 3px;
            color: #8FC50E;
        }
        .toggle-algorithm {
            background: #8FC50E;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px;
            transition: all 0.3s;
        }
        .toggle-algorithm:hover {
            background: #A9D563;
        }
        .key-features {
            background: #f0f9e8;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #8FC50E;
        }
        .key-features h4 {
            margin: 0 0 8px 0;
            color: #6b8e23;
            font-size: 0.95em;
        }
        .key-features ul {
            margin: 0;
            padding-left: 20px;
            font-size: 0.9em;
            color: #556b2f;
        }
        @media (max-width: 768px) {
            .method-grid {
                grid-template-columns: 1fr;
            }
            .header h1 {
                font-size: 2em;
            }
            .stat-number {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <ul class="navbar-nav">
                <li><a href="../../index.html" class="home-link"><i class="fas fa-home"></i> AI4Bio Hub</a></li>
                <li><a href="#2025">2025</a></li>
                <li><a href="#2024">2024</a></li>
                <li><a href="#2023">2023</a></li>
                <li><a href="#2022">2022</a></li>
                <li><a href="#2021">2021</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <div class="container">
            <div class="header">
                <h1>🧬 Single-Cell Drug Response Prediction</h1>
                <p class="subtitle">A Comprehensive Guide to 18 Computational Methods (2021-2025)</p>
                <p class="description">
                    Discover cutting-edge algorithms that predict drug responses at single-cell resolution, enabling personalized medicine 
                    and precision oncology. From transfer learning to transformers, explore how AI is revolutionizing drug discovery.
                </p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-number">18</span>
                    <span class="stat-label">Methods</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">5</span>
                    <span class="stat-label">Years (2021-2025)</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">7</span>
                    <span class="stat-label">Published in 2024-25</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">100%</span>
                    <span class="stat-label">Open Source</span>
                </div>
            </div>

            <div class="filter-section">
                <h3 style="text-align: center; color: #1a5f7a; margin-bottom: 20px;">Filter by Method Type</h3>
                <div class="filter-buttons">
                    <button class="filter-btn active" data-filter="all">All Methods</button>
                    <button class="filter-btn" data-filter="transfer">Transfer Learning</button>
                    <button class="filter-btn" data-filter="transformer">Transformers</button>
                    <button class="filter-btn" data-filter="grn">GRN-Based</button>
                    <button class="filter-btn" data-filter="heterogeneity">Heterogeneity</button>
                    <button class="filter-btn" data-filter="database">Databases</button>
                    <button class="filter-btn" data-filter="repurposing">Drug Repurposing</button>
                </div>
            </div>

            <!-- 2025 Methods -->
            <div class="timeline-year" id="2025">
                <h2>📅 2025 - Next Generation AI (5 methods)</h2>
                <div class="method-grid">
                    
                    <!-- scPDS -->
                    <div class="method-card transformer" data-category="transformer">
                        <div class="method-header">
                            <h3 class="method-name">scPDS</h3>
                            <div class="method-badges">
                                <span class="badge badge-transformer">Transformer</span>
                                <span class="badge badge-year">2025</span>
                            </div>
                        </div>
                        <p class="method-journal">Small Methods (Wiley-VCH)</p>
                        <p class="method-description">
                            Pathway-based Transformer network predicting cancer drug responses from single-cell RNA-seq through biological pathway activation.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Transforms gene expression into pathway activation scores</li>
                                <li>Self-attention mechanism captures pathway interactions</li>
                                <li>Interpretable through pathway importance weights</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-robot"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> scRNA-seq matrix X ∈ ℝ^(n×g), drug library D<br>
                                <strong>Output:</strong> Drug sensitivity scores S ∈ ℝ^(n×d)<br><br>
                                <ol>
                                    <li><strong>Pathway Transformation:</strong>
                                        <br>&nbsp;&nbsp;For each cell i, compute pathway scores:
                                        <br>&nbsp;&nbsp;<code>P_i = PathwayEnrichment(X_i, PathwayDB)</code>
                                        <br>&nbsp;&nbsp;P ∈ ℝ^(n×p) where p = number of pathways
                                    </li>
                                    <li><strong>Pathway Embedding:</strong>
                                        <br>&nbsp;&nbsp;<code>E = Linear(P) + PositionalEncoding</code>
                                        <br>&nbsp;&nbsp;E ∈ ℝ^(n×d_model)
                                    </li>
                                    <li><strong>Multi-Head Self-Attention:</strong>
                                        <br>&nbsp;&nbsp;<code>Q, K, V = W_Q·E, W_K·E, W_V·E</code>
                                        <br>&nbsp;&nbsp;<code>Attention = softmax(QK^T/√d_k)V</code>
                                        <br>&nbsp;&nbsp;<code>MultiHead = Concat(head_1,...,head_h)W_O</code>
                                    </li>
                                    <li><strong>Feed-Forward Network:</strong>
                                        <br>&nbsp;&nbsp;<code>H = LayerNorm(MultiHead + E)</code>
                                        <br>&nbsp;&nbsp;<code>FFN = max(0, HW_1 + b_1)W_2 + b_2</code>
                                        <br>&nbsp;&nbsp;<code>Output = LayerNorm(FFN + H)</code>
                                    </li>
                                    <li><strong>Drug Response Prediction:</strong>
                                        <br>&nbsp;&nbsp;<code>S = Sigmoid(Linear(Output))</code>
                                        <br>&nbsp;&nbsp;Loss = MSE(S, Y_true) + λ·PathwayRegularization
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/39962810/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://onlinelibrary.wiley.com/doi/10.1002/smtd.202400991" target="_blank" class="method-link">
                                <i class="fas fa-file-alt"></i> Paper
                            </a>
                        </div>
                    </div>

                    <!-- scDrugAct -->
                    <div class="method-card database" data-category="database">
                        <div class="method-header">
                            <h3 class="method-name">scDrugAct</h3>
                            <div class="method-badges">
                                <span class="badge badge-database">Database</span>
                                <span class="badge badge-year">2025</span>
                            </div>
                        </div>
                        <p class="method-journal">Nucleic Acids Research (Database Issue)</p>
                        <p class="method-description">
                            Comprehensive database with 3.8M+ cells dissecting tumor microenvironment heterogeneity's contribution to drug action and resistance.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>208 datasets across 34 cancer types</li>
                                <li>Drug-gene-cell relationship network</li>
                                <li>TME cell type-specific drug response analysis</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-database"></i> Analysis Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> scRNA-seq from 208 datasets, drug database<br>
                                <strong>Output:</strong> Cell type-specific drug response predictions<br><br>
                                <ol>
                                    <li><strong>Data Integration:</strong>
                                        <br>&nbsp;&nbsp;<code>Integrate 3,838,223 cells using Harmony</code>
                                        <br>&nbsp;&nbsp;<code>CellType = CellTypist(X_integrated)</code>
                                    </li>
                                    <li><strong>Drug-Gene Network Construction:</strong>
                                        <br>&nbsp;&nbsp;For each drug d:
                                        <br>&nbsp;&nbsp;<code>TargetGenes_d = QueryChEMBL(d)</code>
                                        <br>&nbsp;&nbsp;<code>Network_d = BuildGraph(TargetGenes_d, PPI)</code>
                                    </li>
                                    <li><strong>Cell Type Enrichment:</strong>
                                        <br>&nbsp;&nbsp;For each cell type c:
                                        <br>&nbsp;&nbsp;<code>DEG_c = FindMarkers(X, celltype=c)</code>
                                        <br>&nbsp;&nbsp;<code>Enrichment_cd = GSEA(DEG_c, TargetGenes_d)</code>
                                    </li>
                                    <li><strong>TME Context Analysis:</strong>
                                        <br>&nbsp;&nbsp;<code>TME_score = CalculateTMEscore(X, immune_markers)</code>
                                        <br>&nbsp;&nbsp;<code>Interaction = AnalyzeCellCommunication(X, CellChat)</code>
                                    </li>
                                    <li><strong>Drug Response Scoring:</strong>
                                        <br>&nbsp;&nbsp;<code>Response_cd = f(Enrichment_cd, TME_score, Interaction)</code>
                                        <br>&nbsp;&nbsp;Store in relational database: <code>(Cell, Drug, Response)</code>
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="http://bio-bigdata.hrbmu.edu.cn/scDrugAct/" target="_blank" class="method-link">
                                <i class="fas fa-globe"></i> Database
                            </a>
                            <a href="https://academic.oup.com/nar/article/53/D1/D1536/7889238" target="_blank" class="method-link">
                                <i class="fas fa-file-alt"></i> Paper
                            </a>
                        </div>
                    </div>

                    <!-- scGSDR -->
                    <div class="method-card heterogeneity" data-category="heterogeneity">
                        <div class="method-header">
                            <h3 class="method-name">scGSDR</h3>
                            <div class="method-badges">
                                <span class="badge badge-heterogeneity">Gene Sets</span>
                                <span class="badge badge-year">2025</span>
                            </div>
                        </div>
                        <p class="method-journal">arXiv Preprint</p>
                        <p class="method-description">
                            Gene semantics-based pharmacological profiling integrating cellular states and signaling pathways with interpretability module for resistance identification.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Gene set enrichment for drug mechanism understanding</li>
                                <li>Interpretable resistance phenotype identification</li>
                                <li>Pathway-centric rather than gene-centric</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-project-diagram"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> scRNA-seq X, Gene set database G, Drug profiles D<br>
                                <strong>Output:</strong> Cell-drug response + Resistance mechanisms<br><br>
                                <ol>
                                    <li><strong>Gene Set Scoring:</strong>
                                        <br>&nbsp;&nbsp;For each gene set s ∈ G:
                                        <br>&nbsp;&nbsp;<code>Score_s = GSVA(X, genes_s)</code>
                                        <br>&nbsp;&nbsp;Create gene set matrix: GS ∈ ℝ^(n×|G|)
                                    </li>
                                    <li><strong>Cellular State Encoding:</strong>
                                        <br>&nbsp;&nbsp;<code>Z_cell = Autoencoder(GS)</code>
                                        <br>&nbsp;&nbsp;<code>Z_cell = [z_1, z_2, ..., z_k] ∈ ℝ^k</code>
                                    </li>
                                    <li><strong>Drug Mechanism Encoding:</strong>
                                        <br>&nbsp;&nbsp;For drug d with target genes T_d:
                                        <br>&nbsp;&nbsp;<code>Affected_GS = {s | T_d ∩ genes_s ≠ ∅}</code>
                                        <br>&nbsp;&nbsp;<code>Z_drug = Embed(Affected_GS)</code>
                                    </li>
                                    <li><strong>Response Prediction:</strong>
                                        <br>&nbsp;&nbsp;<code>Interaction = Z_cell ⊙ Z_drug</code>
                                        <br>&nbsp;&nbsp;<code>Response = MLP([Z_cell, Z_drug, Interaction])</code>
                                    </li>
                                    <li><strong>Interpretability Module:</strong>
                                        <br>&nbsp;&nbsp;<code>Attention = softmax(W_a·GS)</code>
                                        <br>&nbsp;&nbsp;<code>Top_pathways = argsort(Attention)[-k:]</code>
                                        <br>&nbsp;&nbsp;Identify resistance: <code>if Response < θ, report Top_pathways</code>
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://arxiv.org/abs/2502.01689" target="_blank" class="method-link">
                                <i class="fas fa-file-alt"></i> arXiv
                            </a>
                            <a href="https://github.com/ChrisOliver2345/scGSDR" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                    <!-- scPharm -->
                    <div class="method-card heterogeneity" data-category="heterogeneity">
                        <div class="method-header">
                            <h3 class="method-name">scPharm</h3>
                            <div class="method-badges">
                                <span class="badge badge-heterogeneity">Subpopulations</span>
                                <span class="badge badge-year">2025</span>
                            </div>
                        </div>
                        <p class="method-journal">Advanced Science (Wiley-VCH)</p>
                        <p class="method-description">
                            Identifies pharmacological subpopulations of single cells for precision oncology, revealing cell type-specific drug vulnerabilities.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Unsupervised pharmacological subpopulation discovery</li>
                                <li>Drug-specific cell clustering</li>
                                <li>Integration with clinical outcome data</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-users"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> scRNA-seq X, Drug sensitivity data Y<br>
                                <strong>Output:</strong> Pharmacological cell subpopulations C<br><br>
                                <ol>
                                    <li><strong>Drug Response Gene Scoring:</strong>
                                        <br>&nbsp;&nbsp;For each drug d:
                                        <br>&nbsp;&nbsp;<code>ResponseGenes_d = TopCorrelated(Y_d, X)</code>
                                        <br>&nbsp;&nbsp;<code>DrugScore_d = ModuleScore(X, ResponseGenes_d)</code>
                                    </li>
                                    <li><strong>Multi-Drug Embedding:</strong>
                                        <br>&nbsp;&nbsp;Create drug-response matrix: M ∈ ℝ^(n×|D|)
                                        <br>&nbsp;&nbsp;<code>M[i,d] = DrugScore_d(cell_i)</code>
                                        <br>&nbsp;&nbsp;<code>Z = UMAP(M, n_components=50)</code>
                                    </li>
                                    <li><strong>Pharmacological Clustering:</strong>
                                        <br>&nbsp;&nbsp;<code>C = Leiden(Z, resolution=r)</code>
                                        <br>&nbsp;&nbsp;Optimize r to maximize: <code>Silhouette(C) + DrugSeparation(C)</code>
                                    </li>
                                    <li><strong>Subpopulation Characterization:</strong>
                                        <br>&nbsp;&nbsp;For each cluster c:
                                        <br>&nbsp;&nbsp;<code>Markers_c = FindAllMarkers(X, cluster=c)</code>
                                        <br>&nbsp;&nbsp;<code>DrugProfile_c = mean(M[cells ∈ c, :])</code>
                                        <br>&nbsp;&nbsp;<code>Pathway_c = EnrichmentAnalysis(Markers_c)</code>
                                    </li>
                                    <li><strong>Clinical Validation:</strong>
                                        <br>&nbsp;&nbsp;<code>Survival_c = KaplanMeier(Clinical, cluster=c)</code>
                                        <br>&nbsp;&nbsp;<code>TreatmentResponse_c = χ²test(Response, cluster)</code>
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/39560158/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://advanced.onlinelibrary.wiley.com/doi/10.1002/advs.202412419" target="_blank" class="method-link">
                                <i class="fas fa-file-alt"></i> Paper
                            </a>
                        </div>
                    </div>

                    <!-- Shennong -->
                    <div class="method-card transformer" data-category="transformer">
                        <div class="method-header">
                            <h3 class="method-name">Shennong</h3>
                            <div class="method-badges">
                                <span class="badge badge-transformer">Deep Learning</span>
                                <span class="badge badge-year">2025</span>
                            </div>
                        </div>
                        <p class="method-journal">National Science Review</p>
                        <p class="method-description">
                            Deep learning framework for in silico screening of anticancer drugs at single-cell level. Named after the Chinese deity of medicine.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>End-to-end deep learning for virtual screening</li>
                                <li>Cell-line free prediction framework</li>
                                <li>Multi-scale feature extraction from scRNA-seq</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-brain"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> scRNA-seq X, Drug library with SMILES strings<br>
                                <strong>Output:</strong> Predicted IC50 for each cell-drug pair<br><br>
                                <ol>
                                    <li><strong>Cell Representation Learning:</strong>
                                        <br>&nbsp;&nbsp;<code>X_norm = log(CPM(X) + 1)</code>
                                        <br>&nbsp;&nbsp;<code>H_cell = DeepEncoder(X_norm)</code>
                                        <br>&nbsp;&nbsp;Architecture: [genes → 1024 → 512 → 256 → 128]
                                    </li>
                                    <li><strong>Drug Molecular Encoding:</strong>
                                        <br>&nbsp;&nbsp;For drug d with SMILES S_d:
                                        <br>&nbsp;&nbsp;<code>Graph_d = MolToGraph(S_d)</code>
                                        <br>&nbsp;&nbsp;<code>H_drug = GCN(Graph_d)</code>
                                        <br>&nbsp;&nbsp;+ <code>Fingerprint_d = Morgan(S_d, radius=3)</code>
                                    </li>
                                    <li><strong>Cross-Modal Attention:</strong>
                                        <br>&nbsp;&nbsp;<code>Attn = softmax(H_cell·W_Q·(H_drug·W_K)^T / √d_k)</code>
                                        <br>&nbsp;&nbsp;<code>H_interact = Attn·(H_drug·W_V)</code>
                                    </li>
                                    <li><strong>Multi-Task Prediction:</strong>
                                        <br>&nbsp;&nbsp;<code>H_combined = Concat([H_cell, H_drug, H_interact])</code>
                                        <br>&nbsp;&nbsp;<code>IC50 = RegressionHead(H_combined)</code>
                                        <br>&nbsp;&nbsp;<code>Toxicity = ClassificationHead(H_combined)</code>
                                    </li>
                                    <li><strong>Training Strategy:</strong>
                                        <br>&nbsp;&nbsp;Loss = MSE(IC50, Y_true) + λ₁·CE(Toxicity, T_true)
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ λ₂·ContrastiveLoss(H_cell, H_drug)
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/39872221/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="http://bis.zju.edu.cn/shennong/index.html" target="_blank" class="method-link">
                                <i class="fas fa-globe"></i> Web Tool
                            </a>
                            <a href="https://github.com/PeijingZhang/Shennong" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                </div>
            </div>

            <!-- 2024 Methods -->
            <div class="timeline-year" id="2024">
                <h2>📅 2024 - Transformer Era (4 methods)</h2>
                <div class="method-grid">
                    
                    <!-- DrugFormer -->
                    <div class="method-card transformer" data-category="transformer">
                        <div class="method-header">
                            <h3 class="method-name">DrugFormer</h3>
                            <div class="method-badges">
                                <span class="badge badge-transformer">LLM</span>
                                <span class="badge badge-year">2024</span>
                            </div>
                        </div>
                        <p class="method-journal">Advanced Science (Wiley-VCH)</p>
                        <p class="method-description">
                            Graph-augmented language model integrating serialized gene tokens with gene-based knowledge graphs for drug sensitivity prediction.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>First to combine LLM with graph neural networks for drugs</li>
                                <li>Gene-as-language representation</li>
                                <li>Knowledge graph augmentation from biological databases</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-network-wired"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> scRNA-seq X, Gene KG G=(V,E), Drug molecular graph<br>
                                <strong>Output:</strong> Drug sensitivity scores<br><br>
                                <ol>
                                    <li><strong>Gene Tokenization:</strong>
                                        <br>&nbsp;&nbsp;<code>TokenSeq = [gene_1, gene_2, ..., gene_n]</code>
                                        <br>&nbsp;&nbsp;<code>Sorted by expression: X[i] in descending order</code>
                                        <br>&nbsp;&nbsp;<code>E_gene = TokenEmbedding(TokenSeq) + ExpressionEncoding(X[i])</code>
                                    </li>
                                    <li><strong>Knowledge Graph Integration:</strong>
                                        <br>&nbsp;&nbsp;Build gene interaction graph from STRING, BioGRID:
                                        <br>&nbsp;&nbsp;<code>A = AdjacencyMatrix(G)</code>
                                        <br>&nbsp;&nbsp;<code>H_graph = GCN(E_gene, A)</code>
                                        <br>&nbsp;&nbsp;<code>H_graph^(l+1) = σ(D^(-½)AD^(-½)H^(l)W^(l))</code>
                                    </li>
                                    <li><strong>Language Model Processing:</strong>
                                        <br>&nbsp;&nbsp;<code>H_seq = Transformer(E_gene)</code>
                                        <br>&nbsp;&nbsp;<code>H_seq^(l) = MultiHeadAttn(LayerNorm(H^(l-1))) + H^(l-1)</code>
                                    </li>
                                    <li><strong>Graph-Language Fusion:</strong>
                                        <br>&nbsp;&nbsp;<code>H_fused = CrossAttention(H_seq, H_graph)</code>
                                        <br>&nbsp;&nbsp;<code>H_fused = α·H_seq + (1-α)·H_graph</code>
                                        <br>&nbsp;&nbsp;α learned adaptively per sample
                                    </li>
                                    <li><strong>Drug Encoding & Prediction:</strong>
                                        <br>&nbsp;&nbsp;<code>H_drug = GraphIsomorphismNetwork(MolGraph)</code>
                                        <br>&nbsp;&nbsp;<code>H_cell = GlobalPooling(H_fused)</code>
                                        <br>&nbsp;&nbsp;<code>Sensitivity = BilinearInteraction(H_cell, H_drug)</code>
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/39206872/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://github.com/QSong-github/DrugFormer" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                    <!-- scDrugplus -->
                    <div class="method-card transfer" data-category="transfer">
                        <div class="method-header">
                            <h3 class="method-name">scDrug+</h3>
                            <div class="method-badges">
                                <span class="badge badge-transfer">Multimodal</span>
                                <span class="badge badge-year">2024</span>
                            </div>
                        </div>
                        <p class="method-journal">Biomedicine & Pharmacotherapy</p>
                        <p class="method-description">
                            Enhanced version integrating single-cell transcriptomics with drug molecular structure for improved prediction, including novel molecule support.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Molecular structure integration via SMILES</li>
                                <li>Novel drug prediction capability</li>
                                <li>Improved over original scDrug (2022)</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-microscope"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> scRNA-seq X, Drug SMILES, Bulk drug response DB<br>
                                <strong>Output:</strong> Single-cell drug response predictions<br><br>
                                <ol>
                                    <li><strong>Single-Cell Encoding:</strong>
                                        <br>&nbsp;&nbsp;<code>X_bulk_like = PseudoBulk(X)</code>
                                        <br>&nbsp;&nbsp;<code>H_sc = Encoder_sc(X)</code>
                                        <br>&nbsp;&nbsp;<code>H_bulk = Encoder_bulk(X_bulk_like)</code>
                                        <br>&nbsp;&nbsp;Share weights: <code>Encoder_sc ≈ Encoder_bulk</code>
                                    </li>
                                    <li><strong>Molecular Feature Extraction:</strong>
                                        <br>&nbsp;&nbsp;For drug with SMILES S:
                                        <br>&nbsp;&nbsp;<code>MolGraph = RDKit(S)</code>
                                        <br>&nbsp;&nbsp;<code>AtomFeatures = [atom_type, degree, charge, ...]</code>
                                        <br>&nbsp;&nbsp;<code>BondFeatures = [bond_type, conjugated, ring, ...]</code>
                                        <br>&nbsp;&nbsp;<code>H_mol = MPNN(MolGraph)</code>
                                    </li>
                                    <li><strong>Cross-Modal Alignment:</strong>
                                        <br>&nbsp;&nbsp;Learn from bulk data: (X_bulk, Y_bulk)
                                        <br>&nbsp;&nbsp;<code>H_combined_bulk = Concat([H_bulk, H_mol])</code>
                                        <br>&nbsp;&nbsp;<code>Predictor = MLP(H_combined_bulk)</code>
                                        <br>&nbsp;&nbsp;<code>Loss_bulk = MSE(Predictor(·), Y_bulk)</code>
                                    </li>
                                    <li><strong>Transfer to Single-Cell:</strong>
                                        <br>&nbsp;&nbsp;<code>H_combined_sc = Concat([H_sc, H_mol])</code>
                                        <br>&nbsp;&nbsp;<code>Y_sc = Predictor(H_combined_sc)</code>
                                        <br>&nbsp;&nbsp;Fine-tune with: <code>Loss = Loss_bulk + λ·DistributionMatch(H_sc, H_bulk)</code>
                                    </li>
                                    <li><strong>Novel Drug Prediction:</strong>
                                        <br>&nbsp;&nbsp;For unseen drug d_new:
                                        <br>&nbsp;&nbsp;<code>H_mol_new = MPNN(SMILES_new)</code>
                                        <br>&nbsp;&nbsp;<code>Y_new = Predictor([H_sc, H_mol_new])</code>
                                        <br>&nbsp;&nbsp;No retraining needed!
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/38964180/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://github.com/ailabstw/scDrugplus" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                    <!-- scRank -->
                    <div class="method-card grn" data-category="grn">
                        <div class="method-header">
                            <h3 class="method-name">scRank</h3>
                            <div class="method-badges">
                                <span class="badge badge-grn">GRN</span>
                                <span class="badge badge-year">2024</span>
                            </div>
                        </div>
                        <p class="method-journal">Cell Reports Medicine</p>
                        <p class="method-description">
                            Predicts drug-responsive cell types from untreated scRNA-seq using target-perturbed gene regulatory networks. No experimental perturbation needed!
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Virtual drug perturbation via GRN simulation</li>
                                <li>Works on untreated samples only</li>
                                <li>Identifies responsive cell populations without screening</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-project-diagram"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> Untreated scRNA-seq X, Drug target gene T_d<br>
                                <strong>Output:</strong> Ranked cell types by drug responsiveness<br><br>
                                <ol>
                                    <li><strong>Gene Regulatory Network Inference:</strong>
                                        <br>&nbsp;&nbsp;<code>GRN = SCENIC(X)</code>
                                        <br>&nbsp;&nbsp;Or: <code>GRN = GRNBoost2(X)</code>
                                        <br>&nbsp;&nbsp;GRN = {(TF_i, target_j, weight_ij)}
                                    </li>
                                    <li><strong>Baseline Gene Expression:</strong>
                                        <br>&nbsp;&nbsp;For each cell type c:
                                        <br>&nbsp;&nbsp;<code>μ_c = mean(X[cells ∈ c, :])</code>
                                        <br>&nbsp;&nbsp;<code>Σ_c = cov(X[cells ∈ c, :])</code>
                                    </li>
                                    <li><strong>Virtual Drug Perturbation:</strong>
                                        <br>&nbsp;&nbsp;Simulate target gene knockout/inhibition:
                                        <br>&nbsp;&nbsp;<code>X_perturbed = X.copy()</code>
                                        <br>&nbsp;&nbsp;<code>X_perturbed[:, T_d] = 0</code> (or downregulate)
                                        <br>&nbsp;&nbsp;Propagate through GRN:
                                        <br>&nbsp;&nbsp;<code>for t in range(T_steps):</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>X_perturbed = UpdateGRN(X_perturbed, GRN)</code>
                                    </li>
                                    <li><strong>Response Quantification:</strong>
                                        <br>&nbsp;&nbsp;For each cell i:
                                        <br>&nbsp;&nbsp;<code>Response_i = ||X_i - X_perturbed_i||₂</code>
                                        <br>&nbsp;&nbsp;For each cell type c:
                                        <br>&nbsp;&nbsp;<code>Response_c = mean(Response_i | cell_i ∈ c)</code>
                                    </li>
                                    <li><strong>Cell Type Ranking:</strong>
                                        <br>&nbsp;&nbsp;<code>Ranking = argsort(Response_c, descending=True)</code>
                                        <br>&nbsp;&nbsp;Statistical significance:
                                        <br>&nbsp;&nbsp;<code>p_value_c = Wilcoxon(X_c, X_perturbed_c)</code>
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/38754419/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://github.com/ZJUFanLab/scRank" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                    <!-- PERCEPTION -->
                    <div class="method-card transfer" data-category="transfer">
                        <div class="method-header">
                            <h3 class="method-name">PERCEPTION</h3>
                            <div class="method-badges">
                                <span class="badge badge-transfer">Clinical</span>
                                <span class="badge badge-year">2024</span>
                            </div>
                        </div>
                        <p class="method-journal">Nature Cancer</p>
                        <p class="method-description">
                            Predicts patient treatment response and resistance using tumor single-cell transcriptomics. Transfer learning from cell-line screens to patient samples.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Patient-specific predictions from tumor biopsies</li>
                                <li>Identifies resistant subpopulations pre-treatment</li>
                                <li>Validated on multiple cancer types (lung, breast, etc.)</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-hospital"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> Patient tumor scRNA-seq, Cell-line drug screens<br>
                                <strong>Output:</strong> Patient response prediction + Resistant cell IDs<br><br>
                                <ol>
                                    <li><strong>Cell-Line Model Training:</strong>
                                        <br>&nbsp;&nbsp;Train on (X_cellline, Y_drug_response):
                                        <br>&nbsp;&nbsp;<code>Model = RandomForest(n_trees=500)</code>
                                        <br>&nbsp;&nbsp;<code>Features = TopVariableGenes(X_cellline, n=1000)</code>
                                        <br>&nbsp;&nbsp;<code>Model.fit(X_cellline[:, Features], Y)</code>
                                    </li>
                                    <li><strong>Patient Sample Preprocessing:</strong>
                                        <br>&nbsp;&nbsp;<code>X_patient = QC_filter(X_raw)</code>
                                        <br>&nbsp;&nbsp;<code>TumorCells = InferCNV(X_patient)</code>
                                        <br>&nbsp;&nbsp;<code>X_tumor = X_patient[TumorCells, :]</code>
                                    </li>
                                    <li><strong>Domain Adaptation:</strong>
                                        <br>&nbsp;&nbsp;Match cell-line and patient distributions:
                                        <br>&nbsp;&nbsp;<code>X_tumor_norm = BatchCorrection(X_tumor, X_cellline)</code>
                                        <br>&nbsp;&nbsp;Or: <code>X_tumor_norm = Harmony(X_tumor, X_cellline)</code>
                                    </li>
                                    <li><strong>Cell-Level Prediction:</strong>
                                        <br>&nbsp;&nbsp;For each tumor cell i:
                                        <br>&nbsp;&nbsp;<code>Sensitivity_i = Model.predict(X_tumor_norm[i, Features])</code>
                                        <br>&nbsp;&nbsp;Patient-level aggregation:
                                        <br>&nbsp;&nbsp;<code>Response_patient = median(Sensitivity_i)</code>
                                    </li>
                                    <li><strong>Resistance Identification:</strong>
                                        <br>&nbsp;&nbsp;<code>ResistantCells = {i | Sensitivity_i < θ_resistant}</code>
                                        <br>&nbsp;&nbsp;<code>ResistanceMarkers = FindMarkers(X_tumor[ResistantCells, :])</code>
                                        <br>&nbsp;&nbsp;<code>ResistancePathways = EnrichmentAnalysis(ResistanceMarkers)</code>
                                    </li>
                                    <li><strong>Clinical Validation:</strong>
                                        <br>&nbsp;&nbsp;<code>Correlation(Response_patient, Clinical_outcome)</code>
                                        <br>&nbsp;&nbsp;<code>AUC = ROC(Response_patient, ActualResponse)</code>
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://www.nature.com/articles/s43018-024-00756-7" target="_blank" class="method-link">
                                <i class="fas fa-file-alt"></i> Nature
                            </a>
                            <a href="https://github.com/ruppinlab/PERCEPTION" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                </div>
            </div>

            <!-- 2023 Methods -->
            <div class="timeline-year" id="2023">
                <h2>📅 2023 - Consolidation & Clinical Translation (5 methods)</h2>
                <div class="method-grid">
                    
                    <!-- DREEP -->
                    <div class="method-card transfer" data-category="transfer">
                        <div class="method-header">
                            <h3 class="method-name">DREEP</h3>
                            <div class="method-badges">
                                <span class="badge badge-transfer">Transfer</span>
                                <span class="badge badge-year">2023</span>
                            </div>
                        </div>
                        <p class="method-journal">BMC Medicine</p>
                        <p class="method-description">
                            Predicts drug response from single-cell tumor expression profiles using gradient boosting and gene signature analysis.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Gradient boosting for robustness</li>
                                <li>Gene signature-based features</li>
                                <li>Fast inference for clinical use</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-chart-line"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> scRNA-seq tumor profiles X, Drug response data Y<br>
                                <strong>Output:</strong> Drug sensitivity predictions per cell<br><br>
                                <ol>
                                    <li><strong>Gene Signature Extraction:</strong>
                                        <br>&nbsp;&nbsp;For each drug d, derive signature from bulk data:
                                        <br>&nbsp;&nbsp;<code>Signature_d = GDSC_TopGenes(drug=d, n=200)</code>
                                        <br>&nbsp;&nbsp;<code>ScoreMatrix = ModuleScore(X, Signature_d)</code>
                                    </li>
                                    <li><strong>Feature Engineering:</strong>
                                        <br>&nbsp;&nbsp;<code>Features = [</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>SignatureScore,</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>PathwayActivities(X),</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>CellCyclePhase(X),</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>MetabolicState(X)</code>
                                        <br>&nbsp;&nbsp;<code>]</code>
                                    </li>
                                    <li><strong>Gradient Boosting Training:</strong>
                                        <br>&nbsp;&nbsp;<code>Model = XGBoost(</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>objective='reg:squarederror',</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>max_depth=6,</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>n_estimators=500</code>
                                        <br>&nbsp;&nbsp;<code>)</code>
                                        <br>&nbsp;&nbsp;<code>Model.fit(Features_train, Y_train)</code>
                                    </li>
                                    <li><strong>Single-Cell Prediction:</strong>
                                        <br>&nbsp;&nbsp;<code>Response_cell = Model.predict(Features_cell)</code>
                                        <br>&nbsp;&nbsp;Confidence intervals via bootstrapping
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/38041118/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://github.com/gambalab/DREEP" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                    <!-- comboSC -->
                    <div class="method-card heterogeneity" data-category="heterogeneity">
                        <div class="method-header">
                            <h3 class="method-name">comboSC</h3>
                            <div class="method-badges">
                                <span class="badge badge-heterogeneity">Combo Therapy</span>
                                <span class="badge badge-year">2023</span>
                            </div>
                        </div>
                        <p class="method-journal">Genome Medicine</p>
                        <p class="method-description">
                            Optimizes personalized tumor combination therapy using single-cell transcriptome and bipartite graph networks for drug synergy prediction.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Drug combination optimization</li>
                                <li>Bipartite graph for drug-cell interactions</li>
                                <li>Personalized multi-drug regimens</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-pills"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> Patient scRNA-seq X, Drug combination database<br>
                                <strong>Output:</strong> Optimal drug combination + Predicted synergy<br><br>
                                <ol>
                                    <li><strong>Bipartite Graph Construction:</strong>
                                        <br>&nbsp;&nbsp;Nodes: {Cells} ∪ {Drugs}
                                        <br>&nbsp;&nbsp;Edges: (cell_i, drug_d) weighted by predicted response
                                        <br>&nbsp;&nbsp;<code>Graph = BipartiteGraph(Cells, Drugs)</code>
                                        <br>&nbsp;&nbsp;<code>W[i,d] = PredictedResponse(cell_i, drug_d)</code>
                                    </li>
                                    <li><strong>Single-Drug Response:</strong>
                                        <br>&nbsp;&nbsp;For each drug d:
                                        <br>&nbsp;&nbsp;<code>Response_d = DrugResponseModel(X, drug_d)</code>
                                        <br>&nbsp;&nbsp;Aggregate across cells: <code>Effect_d = f(Response_d)</code>
                                    </li>
                                    <li><strong>Synergy Score Calculation:</strong>
                                        <br>&nbsp;&nbsp;For drug pair (d1, d2):
                                        <br>&nbsp;&nbsp;<code>Synergy = Bliss(Response_d1, Response_d2)</code>
                                        <br>&nbsp;&nbsp;Or: <code>Synergy = HSA(Response_d1, Response_d2)</code>
                                        <br>&nbsp;&nbsp;Bliss: <code>E_bliss = E_d1 + E_d2 - E_d1·E_d2</code>
                                        <br>&nbsp;&nbsp;<code>Synergy_score = E_observed - E_bliss</code>
                                    </li>
                                    <li><strong>Graph Neural Network:</strong>
                                        <br>&nbsp;&nbsp;<code>H_cell = GNN_cell(X, Graph)</code>
                                        <br>&nbsp;&nbsp;<code>H_drug = GNN_drug(DrugFeatures, Graph)</code>
                                        <br>&nbsp;&nbsp;<code>Synergy_pred = MLP([H_cell, H_drug_1, H_drug_2])</code>
                                    </li>
                                    <li><strong>Combination Optimization:</strong>
                                        <br>&nbsp;&nbsp;<code>BestCombo = argmax_{d1,d2} Synergy_score(d1, d2)</code>
                                        <br>&nbsp;&nbsp;subject to: <code>Toxicity(d1, d2) < threshold</code>
                                        <br>&nbsp;&nbsp;<code>Coverage(d1, d2, TumorCells) > 90%</code>
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/38041202/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://www.combosc.top" target="_blank" class="method-link">
                                <i class="fas fa-globe"></i> Web Server
                            </a>
                            <a href="https://github.com/bm2-lab/comboSC" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                    <!-- Drug2cell -->
                    <div class="method-card database" data-category="database">
                        <div class="method-header">
                            <h3 class="method-name">Drug2cell</h3>
                            <div class="method-badges">
                                <span class="badge badge-database">Druggable Targets</span>
                                <span class="badge badge-year">2023</span>
                            </div>
                        </div>
                        <p class="method-journal">Nature</p>
                        <p class="method-description">
                            Druggable target prediction tool leveraging single-cell profiles and ChEMBL interactions. Demonstrated in cardiac tissue but applicable broadly.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Links cell type markers to druggable targets</li>
                                <li>Integrates ChEMBL drug-target database</li>
                                <li>Spatial and temporal context support</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-bullseye"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> scRNA-seq X, ChEMBL database, Cell annotations<br>
                                <strong>Output:</strong> Ranked druggable targets per cell type<br><br>
                                <ol>
                                    <li><strong>Cell Type Marker Identification:</strong>
                                        <br>&nbsp;&nbsp;For each cell type c:
                                        <br>&nbsp;&nbsp;<code>Markers_c = FindMarkers(X, celltype=c)</code>
                                        <br>&nbsp;&nbsp;<code>Filter: log2FC > 1, p_adj < 0.05</code>
                                    </li>
                                    <li><strong>Druggable Gene Annotation:</strong>
                                        <br>&nbsp;&nbsp;<code>DruggableGenes = QueryChEMBL(</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>target_type=['SINGLE PROTEIN'],</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>max_phase >= 1</code>
                                        <br>&nbsp;&nbsp;<code>)</code>
                                    </li>
                                    <li><strong>Target-Drug Mapping:</strong>
                                        <br>&nbsp;&nbsp;<code>DruggableMarkers = Markers_c ∩ DruggableGenes</code>
                                        <br>&nbsp;&nbsp;For each marker m in DruggableMarkers:
                                        <br>&nbsp;&nbsp;<code>Drugs_m = GetDrugs(m, ChEMBL)</code>
                                        <br>&nbsp;&nbsp;<code>ClinicalPhase_m = max(phase for d in Drugs_m)</code>
                                    </li>
                                    <li><strong>Target Scoring:</strong>
                                        <br>&nbsp;&nbsp;<code>Score_m = (</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>log2FC_m * Specificity_m * ClinicalPhase_m</code>
                                        <br>&nbsp;&nbsp;<code>) / (</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>1 + OffTargetEffects_m</code>
                                        <br>&nbsp;&nbsp;<code>)</code>
                                    </li>
                                    <li><strong>Prioritization & Validation:</strong>
                                        <br>&nbsp;&nbsp;<code>RankedTargets = argsort(Score, descending=True)</code>
                                        <br>&nbsp;&nbsp;Cross-reference with:
                                        <br>&nbsp;&nbsp;- <code>OpenTargets(disease associations)</code>
                                        <br>&nbsp;&nbsp;- <code>SafetyDB(adverse events)</code>
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/37438528/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://github.com/Teichlab/drug2cell" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                    <!-- ASGARD -->
                    <div class="method-card repurposing" data-category="repurposing">
                        <div class="method-header">
                            <h3 class="method-name">ASGARD</h3>
                            <div class="method-badges">
                                <span class="badge badge-repurposing">Repurposing</span>
                                <span class="badge badge-year">2023</span>
                            </div>
                        </div>
                        <p class="method-journal">Nature Communications</p>
                        <p class="method-description">
                            A Single-cell Guided pipeline to Aid Repurposing of Drugs. Comprehensive workflow for identifying repurposing candidates from scRNA-seq.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>End-to-end repurposing workflow</li>
                                <li>Disease signature matching</li>
                                <li>FDA-approved drug prioritization</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-recycle"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> Disease scRNA-seq X_disease, Drug signatures DB<br>
                                <strong>Output:</strong> Ranked repurposing candidates<br><br>
                                <ol>
                                    <li><strong>Disease Signature Extraction:</strong>
                                        <br>&nbsp;&nbsp;<code>DiseaseCells = IdentifyDiseasedCells(X_disease)</code>
                                        <br>&nbsp;&nbsp;<code>DEGs = DifferentialExpression(</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>DiseaseCells vs HealthyCells</code>
                                        <br>&nbsp;&nbsp;<code>)</code>
                                        <br>&nbsp;&nbsp;<code>UpGenes, DownGenes = split(DEGs, by='direction')</code>
                                    </li>
                                    <li><strong>Drug Signature Database:</strong>
                                        <br>&nbsp;&nbsp;Query CMap, LINCS, DrugBank:
                                        <br>&nbsp;&nbsp;<code>DrugSignatures = {</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>drug_id: (UpGenes_drug, DownGenes_drug)</code>
                                        <br>&nbsp;&nbsp;<code>}</code>
                                    </li>
                                    <li><strong>Connectivity Score:</strong>
                                        <br>&nbsp;&nbsp;For each drug d:
                                        <br>&nbsp;&nbsp;<code>CS_up = -EnrichmentScore(</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>UpGenes_disease, DownGenes_drug</code>
                                        <br>&nbsp;&nbsp;<code>)</code>
                                        <br>&nbsp;&nbsp;<code>CS_down = -EnrichmentScore(</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>DownGenes_disease, UpGenes_drug</code>
                                        <br>&nbsp;&nbsp;<code>)</code>
                                        <br>&nbsp;&nbsp;<code>CS_total = (CS_up + CS_down) / 2</code>
                                    </li>
                                    <li><strong>Statistical Validation:</strong>
                                        <br>&nbsp;&nbsp;<code>p_value = PermutationTest(CS_total, n=10000)</code>
                                        <br>&nbsp;&nbsp;<code>FDR = BenjaminiHochberg(p_values)</code>
                                    </li>
                                    <li><strong>Clinical Filtering:</strong>
                                        <br>&nbsp;&nbsp;<code>Candidates = Filter(</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>CS_total < -0.5,</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>FDR < 0.05,</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>FDA_approved = True,</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>SafetyProfile = 'Acceptable'</code>
                                        <br>&nbsp;&nbsp;<code>)</code>
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/36813801/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://github.com/lanagarmire/ASGARD" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                    <!-- SCAD -->
                    <div class="method-card transfer" data-category="transfer">
                        <div class="method-header">
                            <h3 class="method-name">SCAD</h3>
                            <div class="method-badges">
                                <span class="badge badge-transfer">Domain Adapt</span>
                                <span class="badge badge-year">2023</span>
                            </div>
                        </div>
                        <p class="method-journal">Advanced Science (Wiley-VCH)</p>
                        <p class="method-description">
                            Enables single-cell drug response annotations from bulk RNA-seq using adversarial domain adaptation for transfer learning.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Adversarial domain adaptation</li>
                                <li>Identifies pre-existing resistant subpopulations</li>
                                <li>No single-cell drug screening needed</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-exchange-alt"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> Bulk RNA-seq + drug response (X_bulk, Y), scRNA-seq X_sc<br>
                                <strong>Output:</strong> Single-cell drug response annotations<br><br>
                                <ol>
                                    <li><strong>Feature Extractor (Shared):</strong>
                                        <br>&nbsp;&nbsp;<code>G_f: input → features</code>
                                        <br>&nbsp;&nbsp;<code>F_bulk = G_f(X_bulk)</code>
                                        <br>&nbsp;&nbsp;<code>F_sc = G_f(X_sc)</code>
                                        <br>&nbsp;&nbsp;Shared weights for both domains
                                    </li>
                                    <li><strong>Drug Response Predictor:</strong>
                                        <br>&nbsp;&nbsp;<code>G_y: features → drug_response</code>
                                        <br>&nbsp;&nbsp;Train on bulk: <code>Y_pred_bulk = G_y(F_bulk)</code>
                                        <br>&nbsp;&nbsp;<code>L_response = MSE(Y_pred_bulk, Y_bulk)</code>
                                    </li>
                                    <li><strong>Domain Discriminator:</strong>
                                        <br>&nbsp;&nbsp;<code>G_d: features → domain_label</code>
                                        <br>&nbsp;&nbsp;Binary classification: {bulk=0, single-cell=1}
                                        <br>&nbsp;&nbsp;<code>D_bulk = G_d(F_bulk)</code>
                                        <br>&nbsp;&nbsp;<code>D_sc = G_d(F_sc)</code>
                                        <br>&nbsp;&nbsp;<code>L_domain = CE(D_bulk, 0) + CE(D_sc, 1)</code>
                                    </li>
                                    <li><strong>Adversarial Training:</strong>
                                        <br>&nbsp;&nbsp;Minimax game:
                                        <br>&nbsp;&nbsp;<code>min_{G_f, G_y} max_{G_d} L_total</code>
                                        <br>&nbsp;&nbsp;<code>L_total = L_response - λ·L_domain</code>
                                        <br>&nbsp;&nbsp;Goal: Features indistinguishable between domains
                                    </li>
                                    <li><strong>Single-Cell Inference:</strong>
                                        <br>&nbsp;&nbsp;<code>F_sc_aligned = G_f(X_sc)</code>
                                        <br>&nbsp;&nbsp;<code>Y_sc = G_y(F_sc_aligned)</code>
                                        <br>&nbsp;&nbsp;Identify resistant cells: <code>Y_sc < threshold</code>
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/36762572/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10104628/" target="_blank" class="method-link">
                                <i class="fas fa-file-alt"></i> PMC
                            </a>
                        </div>
                    </div>

                </div>
            </div>

            <!-- 2022 Methods -->
            <div class="timeline-year" id="2022">
                <h2>📅 2022 - Transfer Learning Foundations (2 methods)</h2>
                <div class="method-grid">
                    
                    <!-- scDrug -->
                    <div class="method-card transfer" data-category="transfer">
                        <div class="method-header">
                            <h3 class="method-name">scDrug</h3>
                            <div class="method-badges">
                                <span class="badge badge-transfer">Workflow</span>
                                <span class="badge badge-year">2022</span>
                            </div>
                        </div>
                        <p class="method-journal">Computational & Structural Biotechnology Journal</p>
                        <p class="method-description">
                            Integrated workflow from scRNA-seq analysis to drug response prediction. Foundation for later scDrug+ enhancement.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Complete analysis pipeline</li>
                                <li>Tumor cell identification module</li>
                                <li>Functional annotation integration</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-stream"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> Raw scRNA-seq, Bulk drug screen DB<br>
                                <strong>Output:</strong> Cell-level drug response predictions<br><br>
                                <ol>
                                    <li><strong>scRNA-seq Preprocessing:</strong>
                                        <br>&nbsp;&nbsp;<code>X_raw = ReadCountMatrix()</code>
                                        <br>&nbsp;&nbsp;<code>X_qc = QualityControl(X_raw)</code>
                                        <br>&nbsp;&nbsp;<code>X_norm = LogNormalize(X_qc)</code>
                                        <br>&nbsp;&nbsp;<code>X_hvg = SelectHVG(X_norm, n=2000)</code>
                                    </li>
                                    <li><strong>Tumor Cell Identification:</strong>
                                        <br>&nbsp;&nbsp;<code>CNV = InferCNV(X_hvg, reference=normal_cells)</code>
                                        <br>&nbsp;&nbsp;<code>TumorScore = CNVScore(CNV)</code>
                                        <br>&nbsp;&nbsp;<code>TumorCells = {i | TumorScore_i > threshold}</code>
                                    </li>
                                    <li><strong>Pseudo-bulk Aggregation:</strong>
                                        <br>&nbsp;&nbsp;<code>X_pseudobulk = AggregateCells(X_hvg[TumorCells])</code>
                                        <br>&nbsp;&nbsp;Match bulk expression distribution
                                    </li>
                                    <li><strong>Drug Response Model:</strong>
                                        <br>&nbsp;&nbsp;Train on bulk: (X_bulk_train, Y_drug)
                                        <br>&nbsp;&nbsp;<code>Model = ElasticNet(α=0.5)</code>
                                        <br>&nbsp;&nbsp;<code>Model.fit(X_bulk_train, Y_drug)</code>
                                    </li>
                                    <li><strong>Transfer to Single-Cell:</strong>
                                        <br>&nbsp;&nbsp;<code>Calibration = FitTransform(X_pseudobulk, X_bulk)</code>
                                        <br>&nbsp;&nbsp;<code>X_sc_calibrated = Calibration(X_hvg[TumorCells])</code>
                                        <br>&nbsp;&nbsp;<code>Y_sc = Model.predict(X_sc_calibrated)</code>
                                    </li>
                                    <li><strong>Functional Annotation:</strong>
                                        <br>&nbsp;&nbsp;<code>SensitiveCells = {i | Y_sc[i] < IC50_threshold}</code>
                                        <br>&nbsp;&nbsp;<code>Markers = FindMarkers(SensitiveCells)</code>
                                        <br>&nbsp;&nbsp;<code>Pathways = EnrichmentAnalysis(Markers)</code>
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/36544472/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://github.com/ailabstw/scDrug" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                    <!-- scDEAL -->
                    <div class="method-card transfer" data-category="transfer">
                        <div class="method-header">
                            <h3 class="method-name">scDEAL</h3>
                            <div class="method-badges">
                                <span class="badge badge-transfer">Deep Transfer</span>
                                <span class="badge badge-year">2022</span>
                            </div>
                        </div>
                        <p class="method-journal">Nature Communications</p>
                        <p class="method-description">
                            Deep transfer learning framework integrating bulk and single-cell RNA-seq for cancer drug response prediction using neural networks.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Deep neural architecture for transfer</li>
                                <li>Multi-task learning framework</li>
                                <li>Addresses batch effects systematically</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-layer-group"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> Bulk (X_bulk, Y_bulk), scRNA-seq X_sc<br>
                                <strong>Output:</strong> Single-cell drug sensitivity Y_sc<br><br>
                                <ol>
                                    <li><strong>Shared Feature Encoder:</strong>
                                        <br>&nbsp;&nbsp;<code>Encoder: ℝ^genes → ℝ^hidden</code>
                                        <br>&nbsp;&nbsp;<code>H_bulk = Encoder(X_bulk)</code>
                                        <br>&nbsp;&nbsp;<code>H_sc = Encoder(X_sc)</code>
                                        <br>&nbsp;&nbsp;Architecture: [genes → 1024 → 512 → 256]
                                    </li>
                                    <li><strong>Drug Response Predictor:</strong>
                                        <br>&nbsp;&nbsp;<code>Predictor: ℝ^hidden → ℝ^drugs</code>
                                        <br>&nbsp;&nbsp;Train on bulk first:
                                        <br>&nbsp;&nbsp;<code>Y_pred_bulk = Predictor(H_bulk)</code>
                                        <br>&nbsp;&nbsp;<code>L_bulk = MSE(Y_pred_bulk, Y_bulk)</code>
                                    </li>
                                    <li><strong>Distribution Matching:</strong>
                                        <br>&nbsp;&nbsp;Maximum Mean Discrepancy (MMD):
                                        <br>&nbsp;&nbsp;<code>L_mmd = ||E[φ(H_bulk)] - E[φ(H_sc)]||²</code>
                                        <br>&nbsp;&nbsp;φ: RBF kernel feature map
                                    </li>
                                    <li><strong>Multi-Task Training:</strong>
                                        <br>&nbsp;&nbsp;<code>L_total = L_bulk + λ₁·L_mmd + λ₂·L_recon</code>
                                        <br>&nbsp;&nbsp;<code>L_recon = ||Decoder(H_sc) - X_sc||²</code>
                                        <br>&nbsp;&nbsp;Reconstruction ensures meaningful features
                                    </li>
                                    <li><strong>Single-Cell Prediction:</strong>
                                        <br>&nbsp;&nbsp;<code>H_sc_aligned = Encoder(X_sc)</code>
                                        <br>&nbsp;&nbsp;<code>Y_sc = Predictor(H_sc_aligned)</code>
                                        <br>&nbsp;&nbsp;No additional labels needed!
                                    </li>
                                    <li><strong>Confidence Estimation:</strong>
                                        <br>&nbsp;&nbsp;<code>Uncertainty = MonteCarloDropout(Predictor, n=100)</code>
                                        <br>&nbsp;&nbsp;<code>CI = percentile(predictions, [2.5, 97.5])</code>
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/36310235/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://github.com/OSU-BMBL/scDEAL" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                </div>
            </div>

            <!-- 2021 Methods -->
            <div class="timeline-year" id="2021">
                <h2>📅 2021 - Field Pioneers (2 methods)</h2>
                <div class="method-grid">
                    
                    <!-- CaDRReS-Sc -->
                    <div class="method-card heterogeneity" data-category="heterogeneity">
                        <div class="method-header">
                            <h3 class="method-name">CaDRReS-Sc</h3>
                            <div class="method-badges">
                                <span class="badge badge-heterogeneity">Recommender</span>
                                <span class="badge badge-year">2021</span>
                            </div>
                        </div>
                        <p class="method-journal">Genome Medicine</p>
                        <p class="method-description">
                            Recommender system predicting heterogeneity in clone-specific therapeutic vulnerabilities using single-cell transcriptomic signatures.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Matrix factorization recommender system</li>
                                <li>Clone-level prediction granularity</li>
                                <li>Focus on Crizotinib resistance in ALK+ cancer</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-star"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> Bulk response matrix R, scRNA-seq X_sc<br>
                                <strong>Output:</strong> Clone-specific drug vulnerabilities<br><br>
                                <ol>
                                    <li><strong>Matrix Factorization (Bulk):</strong>
                                        <br>&nbsp;&nbsp;Response matrix: R ∈ ℝ^(cell-lines × drugs)
                                        <br>&nbsp;&nbsp;<code>R ≈ C × F^T</code>
                                        <br>&nbsp;&nbsp;C: cell-line features, F: drug features
                                        <br>&nbsp;&nbsp;<code>min ||R - CF^T||² + λ(||C||² + ||F||²)</code>
                                    </li>
                                    <li><strong>Gene Feature Selection:</strong>
                                        <br>&nbsp;&nbsp;<code>ImportantGenes = TopContributors(C)</code>
                                        <br>&nbsp;&nbsp;Based on feature importance in C matrix
                                    </li>
                                    <li><strong>Clone Identification:</strong>
                                        <br>&nbsp;&nbsp;<code>Clones = ClusterCells(X_sc)</code>
                                        <br>&nbsp;&nbsp;Using Seurat/Scanpy clustering
                                        <br>&nbsp;&nbsp;<code>CloneSigs = MeanExpression(X_sc, by=Clone)</code>
                                    </li>
                                    <li><strong>Single-Cell Calibration:</strong>
                                        <br>&nbsp;&nbsp;Map clone signatures to cell-line space:
                                        <br>&nbsp;&nbsp;<code>C_clone = CalibrationFunction(CloneSigs, ImportantGenes)</code>
                                        <br>&nbsp;&nbsp;Normalize to match bulk distribution
                                    </li>
                                    <li><strong>Drug Response Prediction:</strong>
                                        <br>&nbsp;&nbsp;For each clone c:
                                        <br>&nbsp;&nbsp;<code>R_clone_c = C_clone_c × F^T</code>
                                        <br>&nbsp;&nbsp;<code>VulnerableDrugs_c = {d | R_clone_c[d] > threshold}</code>
                                    </li>
                                    <li><strong>Heterogeneity Quantification:</strong>
                                        <br>&nbsp;&nbsp;<code>Heterogeneity_d = Variance(R_clone[:, d])</code>
                                        <br>&nbsp;&nbsp;High variance → heterogeneous response
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/34915921/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://github.com/CSB5/CaDRReS-Sc" target="_blank" class="method-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>

                    <!-- Beyondcell -->
                    <div class="method-card heterogeneity" data-category="heterogeneity">
                        <div class="method-header">
                            <h3 class="method-name">Beyondcell</h3>
                            <div class="method-badges">
                                <span class="badge badge-heterogeneity">Enrichment</span>
                                <span class="badge badge-year">2021</span>
                            </div>
                        </div>
                        <p class="method-journal">Genome Medicine</p>
                        <p class="method-description">
                            Targets cancer therapeutic heterogeneity using enrichment scores from drug signatures to identify subpopulations with distinct drug responses.
                        </p>
                        <div class="key-features">
                            <h4>🔑 Key Innovation:</h4>
                            <ul>
                                <li>Drug signature enrichment methodology</li>
                                <li>Therapeutic clusters identification</li>
                                <li>Visualization of response heterogeneity</li>
                            </ul>
                        </div>
                        <button class="toggle-algorithm" onclick="toggleAlgorithm(this)">
                            <i class="fas fa-code"></i> Show Algorithm
                        </button>
                        <div class="algorithm-section">
                            <div class="algorithm-title">
                                <i class="fas fa-chart-area"></i> Algorithm Pipeline
                            </div>
                            <div class="algorithm-steps">
                                <strong>Input:</strong> scRNA-seq X, Drug signature collections<br>
                                <strong>Output:</strong> Therapeutic clusters + Response heterogeneity<br><br>
                                <ol>
                                    <li><strong>Drug Signature Collection:</strong>
                                        <br>&nbsp;&nbsp;From DSigDB, CMap, etc.:
                                        <br>&nbsp;&nbsp;<code>Signatures = {</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>drug_d: (UpGenes, DownGenes)</code>
                                        <br>&nbsp;&nbsp;<code>}</code>
                                    </li>
                                    <li><strong>Enrichment Score Calculation:</strong>
                                        <br>&nbsp;&nbsp;For each cell i and drug d:
                                        <br>&nbsp;&nbsp;<code>ES_i_d = GSEA_like(</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>RankedGenes(X[i,:]),</code>
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;<code>Signature_d</code>
                                        <br>&nbsp;&nbsp;<code>)</code>
                                        <br>&nbsp;&nbsp;Create BCS matrix: BCS ∈ ℝ^(cells × drugs)
                                    </li>
                                    <li><strong>Beyondcell Score (BCS):</strong>
                                        <br>&nbsp;&nbsp;<code>BCS[i,d] = (ES_up - ES_down) / 2</code>
                                        <br>&nbsp;&nbsp;Positive BCS → likely sensitive
                                        <br>&nbsp;&nbsp;Negative BCS → likely resistant
                                    </li>
                                    <li><strong>Statistical Significance:</strong>
                                        <br>&nbsp;&nbsp;<code>p_value = PermutationTest(BCS[i,d])</code>
                                        <br>&nbsp;&nbsp;<code>BCS_filtered = BCS[p < 0.05]</code>
                                    </li>
                                    <li><strong>Therapeutic Clustering:</strong>
                                        <br>&nbsp;&nbsp;<code>UMAP_therapeutic = UMAP(BCS)</code>
                                        <br>&nbsp;&nbsp;<code>Clusters = Leiden(UMAP_therapeutic)</code>
                                        <br>&nbsp;&nbsp;Groups cells by drug response profiles
                                    </li>
                                    <li><strong>Heterogeneity Visualization:</strong>
                                        <br>&nbsp;&nbsp;<code>PlotBCS(UMAP_therapeutic, drug=d)</code>
                                        <br>&nbsp;&nbsp;<code>SwitchPlot(cluster_composition)</code>
                                        <br>&nbsp;&nbsp;Shows % cells sensitive per cluster
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div class="method-links">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/34911571/" target="_blank" class="method-link">
                                <i class="fas fa-book"></i> PubMed
                            </a>
                            <a href="https://gitlab.com/bu_cnio/beyondcell" target="_blank" class="method-link">
                                <i class="fab fa-gitlab"></i> GitLab
                            </a>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </main>

    <script>
        // Filter functionality
        const filterBtns = document.querySelectorAll('.filter-btn');
        const methodCards = document.querySelectorAll('.method-card');

        filterBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const filter = btn.dataset.filter;
                
                // Update active button
                filterBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                // Filter cards
                methodCards.forEach(card => {
                    if (filter === 'all' || card.dataset.category === filter) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                });
            });
        });

        // Toggle algorithm visibility
        function toggleAlgorithm(button) {
            const algorithmSection = button.nextElementSibling;
            const isShown = algorithmSection.classList.contains('show');
            
            if (isShown) {
                algorithmSection.classList.remove('show');
                button.innerHTML = '<i class="fas fa-code"></i> Show Algorithm';
            } else {
                algorithmSection.classList.add('show');
                button.innerHTML = '<i class="fas fa-eye-slash"></i> Hide Algorithm';
            }
        }

        // Smooth scroll for navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>
