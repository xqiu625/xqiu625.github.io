<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Self-Verification Agents - AI4Bio Concepts</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Lato', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            line-height: 1.8;
            color: #333;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        .navbar {
            background-color: #ffffff;
            border-bottom: 1px solid #e7e7e7;
            padding: 10px 0;
        }
        .navbar-nav {
            list-style-type: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .navbar-nav li {
            margin: 0 15px;
        }
        .navbar-nav a {
            color: #666666;
            text-decoration: none;
            font-weight: bold;
            font-size: 16px;
        }
        .home-link {
            color: #667eea !important;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
        }
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 2.5em;
        }
        .header p {
            margin: 5px 0;
            font-size: 1.1em;
            opacity: 0.9;
        }
        .paper-ref {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.95em;
        }
        .paper-ref a {
            color: white;
            text-decoration: underline;
        }
        .content-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 25px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .content-section h2 {
            color: #667eea;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .content-section h3 {
            color: #764ba2;
            margin-top: 25px;
        }
        .concept-box {
            background: #f8f9fa;
            border-left: 5px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .concept-box.architecture {
            border-left-color: #764ba2;
        }
        .concept-box.evaluation {
            border-left-color: #e74c3c;
        }
        .concept-box.knowledge {
            border-left-color: #27ae60;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }
        .code-block .comment {
            color: #75715e;
        }
        .code-block .keyword {
            color: #f92672;
        }
        .code-block .function {
            color: #a6e22e;
        }
        .code-block .string {
            color: #e6db74;
        }
        .highlight-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .highlight-box strong {
            color: #856404;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        .stat-card .number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .stat-card .label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        .visual-diagram {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        .flow-step {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 15px 25px;
            margin: 10px;
            border-radius: 8px;
            position: relative;
        }
        .flow-step:after {
            content: '→';
            position: absolute;
            right: -30px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5em;
            color: #667eea;
        }
        .flow-step:last-child:after {
            content: '';
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .comparison-table th {
            background: #667eea;
            color: white;
        }
        .comparison-table tr:hover {
            background: #f5f5f5;
        }
        .tag {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            margin: 5px 5px 5px 0;
        }
        .tag.high {
            background: #27ae60;
        }
        .tag.medium {
            background: #f39c12;
        }
        .tag.low {
            background: #e74c3c;
        }
        ul, ol {
            line-height: 1.8;
        }
        .back-link {
            display: inline-block;
            margin: 20px 0;
            padding: 10px 20px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .back-link:hover {
            background: #764ba2;
            transform: translateX(-5px);
        }
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            .flow-step {
                display: block;
                margin: 10px 0;
            }
            .flow-step:after {
                content: '↓';
                position: relative;
                right: 0;
                display: block;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <ul class="navbar-nav">
                <li><a href="../index.html" class="home-link"><i class="fas fa-book"></i> AI4Bio Concepts Handbook</a></li>
                <li><a href="../../"><i class="fas fa-home"></i> Xinru's Homepage</a></li>
            </ul>
        </div>
    </nav>

    <main role="main">
        <div class="container">
            <div class="header">
                <h1><i class="fas fa-robot"></i> Self-Verification Agents for Scientific Discovery</h1>
                <p>How LLM agents reduce hallucinations through autonomous knowledge verification</p>
                <div class="paper-ref">
                    <strong>Source:</strong> Wang, Z. et al. (2025). GeneAgent: self-verification language agent for gene-set analysis using domain databases. 
                    <em>Nature Methods</em> 22, 1677–1685. 
                    <a href="https://doi.org/10.1038/s41592-025-02748-6" target="_blank">https://doi.org/10.1038/s41592-025-02748-6</a>
                </div>
            </div>

            <!-- Core Concept -->
            <div class="content-section">
                <h2><i class="fas fa-lightbulb"></i> Core Concept</h2>
                <div class="concept-box">
                    <h3>What is a Self-Verification Agent?</h3>
                    <p>A <strong>self-verification agent</strong> is an LLM-based system that autonomously verifies its own outputs by querying external knowledge sources, rather than relying solely on the model's parametric knowledge or human validation.</p>
                    
                    <p><strong>Key Innovation:</strong> Instead of a human checking if the LLM's answer is correct, the agent automatically:</p>
                    <ol>
                        <li>Generates an initial answer</li>
                        <li>Extracts verifiable claims from that answer</li>
                        <li>Queries relevant databases for evidence</li>
                        <li>Determines if each claim is supported, partially supported, or refuted</li>
                        <li>Revises the answer based on verification results</li>
                    </ol>
                </div>

                <div class="highlight-box">
                    <strong><i class="fas fa-exclamation-triangle"></i> Why This Matters:</strong> 
                    LLMs hallucinate—they generate plausible but factually incorrect statements. In scientific domains like genomics, these hallucinations can mislead researchers. Self-verification reduces hallucinations from ~44% to ~19% in gene-set analysis.
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="number">56%</div>
                        <div class="label">Reduction in hallucinations</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">15,903</div>
                        <div class="label">Claims verified</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">99.6%</div>
                        <div class="label">Successfully verified</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">92%</div>
                        <div class="label">Expert-validated accuracy</div>
                    </div>
                </div>
            </div>

            <!-- Architecture -->
            <div class="content-section">
                <h2><i class="fas fa-project-diagram"></i> Architecture: Cascading Verification</h2>
                
                <div class="visual-diagram">
                    <h3>Four-Stage Pipeline</h3>
                    <div style="margin: 30px 0;">
                        <div class="flow-step">1. Generation<br><small>Initial LLM output</small></div>
                        <div class="flow-step">2. Self-Verification<br><small>Query databases</small></div>
                        <div class="flow-step">3. Modification<br><small>Revise based on evidence</small></div>
                        <div class="flow-step">4. Summarization<br><small>Final output</small></div>
                    </div>
                </div>

                <div class="concept-box architecture">
                    <h3>Cascading Verification: Multi-Level Checking</h3>
                    <p>Unlike single-pass verification, GeneAgent verifies at <strong>two levels of granularity</strong>:</p>
                    <ol>
                        <li><strong>Coarse-grained:</strong> Verify the high-level "process name" (e.g., "RTK signaling pathway")</li>
                        <li><strong>Fine-grained:</strong> Verify detailed analytical narratives about individual genes</li>
                    </ol>
                    <p><strong>Key insight:</strong> Process names are verified <strong>twice</strong>—once directly, then again indirectly through the analytical narratives. This catches inconsistencies and prevents error propagation.</p>
                </div>

                <h3>Implementation Pattern</h3>
                <div class="code-block">
<span class="keyword">def</span> <span class="function">self_verification_agent</span>(claim, gene_symbols):
    <span class="comment"># 1. Extract relevant entities (e.g., gene names)</span>
    entities = extract_genes(claim)
    
    <span class="comment"># 2. Autonomously select appropriate databases</span>
    <span class="comment">#    e.g., GO, KEGG, PubMed based on claim type</span>
    relevant_dbs = select_databases(claim_type, entities)
    
    <span class="comment"># 3. Query external knowledge sources via APIs</span>
    evidence = query_databases(entities, relevant_dbs)
    
    <span class="comment"># 4. Generate verification report</span>
    decision = evaluate_claim(claim, evidence)
    <span class="comment">#    → "supported", "partially supported", or "refuted"</span>
    
    <span class="keyword">return</span> VerificationReport(
        decision=decision, 
        evidence=evidence, 
        reasoning=explain_decision(claim, evidence)
    )
                </div>

                <h3>Example: Claim Verification</h3>
                <div class="concept-box">
                    <p><strong>Claim:</strong> "ERBB2, ERBB4, FGFR2, FGFR4, HRAS, KRAS are involved in RTK signaling"</p>
                    <p><strong>Agent Process:</strong></p>
                    <ol>
                        <li>Extracts genes: ERBB2, ERBB4, FGFR2, FGFR4, HRAS, KRAS</li>
                        <li>Queries g:Profiler and Enrichr for enrichment analysis</li>
                        <li>Retrieves top enrichment: "MAPK signaling pathway"</li>
                        <li><strong>Decision:</strong> "Cannot be confirmed" (MAPK is related but not identical to RTK)</li>
                        <li>Agent modifies claim to be more specific or removes it</li>
                    </ol>
                </div>
            </div>

            <!-- Multi-Database Integration -->
            <div class="content-section">
                <h2><i class="fas fa-database"></i> Multi-Database Evidence Synthesis</h2>
                
                <div class="concept-box knowledge">
                    <h3>Why Multiple Databases?</h3>
                    <p>No single database has complete coverage of biological knowledge. GeneAgent integrates <strong>18 databases via 4 Web APIs</strong> to achieve comprehensive verification:</p>
                </div>

                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Database Type</th>
                            <th>Purpose</th>
                            <th>Examples</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>GSEA Tools (8)</strong></td>
                            <td>Pathway enrichment</td>
                            <td>GO, KEGG, Reactome, WikiPathways</td>
                            <td>Verify process names</td>
                        </tr>
                        <tr>
                            <td><strong>Gene-Centric (2)</strong></td>
                            <td>Individual gene functions</td>
                            <td>NCBI Gene, PubMed</td>
                            <td>Verify analytical narratives</td>
                        </tr>
                        <tr>
                            <td><strong>Interactions (3)</strong></td>
                            <td>Protein complexes, PPIs</td>
                            <td>STRING, CORUM, CTD</td>
                            <td>Verify gene relationships</td>
                        </tr>
                        <tr>
                            <td><strong>Disease (1)</strong></td>
                            <td>Gene-disease links</td>
                            <td>Human Phenotype Ontology</td>
                            <td>Verify disease associations</td>
                        </tr>
                    </tbody>
                </table>

                <div class="highlight-box">
                    <strong><i class="fas fa-check-circle"></i> Key Finding:</strong> 
                    93% of successfully verified claims used information from at least one database, demonstrating the necessity of multi-database integration.
                </div>

                <h3>Complementary Coverage Pattern</h3>
                <div class="concept-box">
                    <p><strong>Different verification types require different databases:</strong></p>
                    <ul>
                        <li><strong>Process names</strong> → g:Profiler & Enrichr (pathway enrichment)</li>
                        <li><strong>Analytical narratives</strong> → E-utils & AgentAPI (gene functions)</li>
                    </ul>
                    <p>This specialization ensures that each type of claim is verified against the most appropriate knowledge source.</p>
                </div>
            </div>

            <!-- Evaluation Methodology -->
            <div class="content-section">
                <h2><i class="fas fa-chart-line"></i> Evaluation: Beyond Exact Match</h2>
                
                <div class="concept-box evaluation">
                    <h3>Database Masking: Preventing Data Leakage</h3>
                    <p><strong>Problem:</strong> If your verification database contains the ground truth you're testing against, you're just doing retrieval, not generation.</p>
                    <p><strong>Solution:</strong> Mask databases that contain ground truth during verification:</p>
                    <ul>
                        <li>Testing GO gene sets? → Exclude g:Profiler's GO database</li>
                        <li>Testing MSigDB gene sets? → Exclude Enrichr's MSigDB_Hallmark_2020</li>
                    </ul>
                    <p><strong>Result:</strong> Ensures the agent generates knowledge rather than retrieving memorized annotations.</p>
                </div>

                <h3>Semantic Similarity: Capturing Functional Equivalence</h3>
                <div class="concept-box">
                    <p>Biological concepts have many equivalent phrasings. ROUGE scores (lexical overlap) miss functionally correct predictions.</p>
                    
                    <p><strong>Solution:</strong> Use MedCPT (biomedical language model) to measure semantic similarity:</p>
                    <ul>
                        <li>"Limb morphogenesis" vs "Limb development" → <strong>92.8% similar</strong></li>
                        <li>"Peroxisome" vs "Peroxisome protein" → <strong>95.7% similar</strong></li>
                    </ul>

                    <p><strong>Percentile Ranking:</strong> Compare generated name against 12,320 background terms:</p>
                    <ul>
                        <li><strong>76.9%</strong> of GeneAgent names ranked in top 90th percentile</li>
                        <li><strong>61.0%</strong> in top 98th percentile</li>
                        <li>Demonstrates specificity: names closer to ground truth than vast majority of alternatives</li>
                    </ul>
                </div>

                <h3>Hierarchical Similarity: Ontology-Aware Evaluation</h3>
                <div class="concept-box">
                    <p>Generated names may be broader concepts (ancestor terms) that are still scientifically valid.</p>
                    <p><strong>Finding:</strong> 75.4% of gene sets with 70-90% similarity scores were actually <strong>more similar to ancestor terms</strong> than ground truth.</p>
                    <p><strong>Example:</strong></p>
                    <ul>
                        <li>Ground truth: "Axial mesoderm morphogenesis" (77.2% similarity)</li>
                        <li>Ancestor: "Mesoderm morphogenesis" (82.9% similarity ↑)</li>
                    </ul>
                    <p>This shows the agent correctly identified the broader biological process, which is valuable for interpretation.</p>
                </div>

                <h3>Hallucination Quantification</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="number">56.0%</div>
                        <div class="label">GPT-4 accuracy<br>(44% hallucinations)</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">80.7%</div>
                        <div class="label">GeneAgent accuracy<br>(19.3% hallucinations)</div>
                    </div>
                </div>
                <p style="text-align: center; margin-top: 15px;"><strong>Method:</strong> Compare LLM-generated enrichment terms against significant GSEA results (p ≤ 0.05). Unmatched terms = potential hallucinations.</p>
            </div>

            <!-- Applicability -->
            <div class="content-section">
                <h2><i class="fas fa-arrows-alt"></i> Transferability to Other Domains</h2>
                
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Concept</th>
                            <th>Transferability</th>
                            <th>Applicable Domains</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Self-Verification Agents</strong></td>
                            <td><span class="tag high">Very High</span></td>
                            <td>Any scientific domain with curated databases (chemistry, physics, medicine)</td>
                        </tr>
                        <tr>
                            <td><strong>Cascading Verification</strong></td>
                            <td><span class="tag high">Very High</span></td>
                            <td>Any multi-level reasoning task (hierarchical classification, nested predictions)</td>
                        </tr>
                        <tr>
                            <td><strong>Database Masking</strong></td>
                            <td><span class="tag high">Very High</span></td>
                            <td>Any knowledge-grounded AI system requiring fair evaluation</td>
                        </tr>
                        <tr>
                            <td><strong>Multi-Database Synthesis</strong></td>
                            <td><span class="tag medium">Medium-High</span></td>
                            <td>Medicine, law, climate science (knowledge-intensive domains)</td>
                        </tr>
                        <tr>
                            <td><strong>Semantic Similarity Evaluation</strong></td>
                            <td><span class="tag medium">Medium-High</span></td>
                            <td>Biomedical NLP, ontology-rich domains</td>
                        </tr>
                        <tr>
                            <td><strong>Hallucination Quantification</strong></td>
                            <td><span class="tag high">Very High</span></td>
                            <td>Any domain with gold-standard databases or benchmarks</td>
                        </tr>
                    </tbody>
                </table>

                <div class="highlight-box">
                    <strong><i class="fas fa-lightbulb"></i> Key Takeaway:</strong> 
                    The core principles (autonomous verification, multi-source evidence, ontology-aware evaluation) are domain-agnostic. The specific databases and evaluation metrics need to be adapted to your domain.
                </div>
            </div>

            <!-- Implementation Considerations -->
            <div class="content-section">
                <h2><i class="fas fa-code"></i> Implementation Considerations</h2>
                
                <h3>What You Need</h3>
                <ol>
                    <li><strong>LLM Backend:</strong> GPT-4 or equivalent (Claude, Gemini, open-source models)</li>
                    <li><strong>Domain Databases:</strong> 3-5 curated knowledge sources with API access</li>
                    <li><strong>Evaluation Dataset:</strong> 100+ examples with ground truth for validation</li>
                    <li><strong>Prompt Engineering:</strong> Task-specific prompts for generation, claim extraction, and verification</li>
                </ol>

                <h3>Limitations & Challenges</h3>
                <div class="concept-box">
                    <ul>
                        <li><strong>Database Coverage:</strong> Agent may reject correct answers if databases lack relevant information</li>
                        <li><strong>Database Selection:</strong> Agent might query irrelevant databases, leading to incorrect endorsements</li>
                        <li><strong>Computational Cost:</strong> Multiple API calls add latency (15,903 claims = 19,273 database queries)</li>
                        <li><strong>Single Model:</strong> GeneAgent only tested with GPT-4; performance with other LLMs unknown</li>
                    </ul>
                </div>

                <h3>Open Research Questions</h3>
                <ol>
                    <li>How does self-verification scale to other biological tasks (variant interpretation, drug response)?</li>
                    <li>What's the optimal trade-off between verification thoroughness and efficiency?</li>
                    <li>Can self-verification work with open-source LLMs (Llama, Mistral)?</li>
                    <li>How to incorporate rapidly evolving knowledge (new papers published weekly)?</li>
                </ol>
            </div>

            <!-- Related Concepts -->
            <div class="content-section">
                <h2><i class="fas fa-link"></i> Related Concepts</h2>
                
                <div class="concept-box">
                    <h3>In This Handbook:</h3>
                    <ul>
                        <li><strong>Foundation Models:</strong> 
                            <a href="attention-mechanisms.html">Attention Mechanisms</a> (Coming Soon) - 
                            Understanding how transformers process information
                        </li>
                        <li><strong>Machine Learning:</strong> 
                            <a href="../machine-learning/model-evaluation.html">Model Evaluation</a> (Coming Soon) - 
                            Comprehensive evaluation methodologies
                        </li>
                    </ul>
                </div>

                <div class="concept-box">
                    <h3>Related Work in Literature:</h3>
                    <ul>
                        <li><strong>GeneGPT (Jin et al. 2024):</strong> LLM tool-use for genomics Q&A (predecessor without self-verification)</li>
                        <li><strong>CRITIC (Gou et al. 2024):</strong> Self-correction via tool-interactive critiquing (general framework)</li>
                        <li><strong>SPINDOCTOR (Joachimiak et al. 2024):</strong> Gene synopsis summarization (complementary approach)</li>
                        <li><strong>AutoGen (Wu et al. 2024):</strong> Multi-agent LLM applications (general framework)</li>
                    </ul>
                </div>
            </div>

            <!-- Action Items -->
            <div class="content-section">
                <h2><i class="fas fa-tasks"></i> How to Apply This</h2>
                
                <div class="concept-box">
                    <h3>For Your Research:</h3>
                    <ol>
                        <li><strong>Identify verifiable claims</strong> in your LLM outputs (predictions, explanations, hypotheses)</li>
                        <li><strong>Map to knowledge sources</strong> in your domain (databases, ontologies, literature)</li>
                        <li><strong>Design verification protocol:</strong>
                            <ul>
                                <li>What constitutes "supported" vs "refuted"?</li>
                                <li>How to handle ambiguous or partial matches?</li>
                                <li>Which databases to prioritize for different claim types?</li>
                            </ul>
                        </li>
                        <li><strong>Implement masking strategy</strong> to prevent data leakage during evaluation</li>
                        <li><strong>Validate with experts</strong> on a sample (10-20 examples) to ensure correct decisions</li>
                    </ol>
                </div>

                <div class="highlight-box">
                    <strong><i class="fas fa-star"></i> Start Simple:</strong> 
                    Begin with single-database verification on a small test set (20-50 examples). Once working, expand to multi-database synthesis and larger datasets.
                </div>
            </div>

            <a href="../index.html" class="back-link"><i class="fas fa-arrow-left"></i> Back to Handbook</a>
        </div>
    </main>

    <footer>
        <div class="container" style="text-align: center; margin-top: 40px; padding: 20px; color: #666;">
            <p>Part of <a href="../../" style="color: #667eea;">Xinru Qiu's</a> AI4Bio Concepts Handbook</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Last updated: January 2025</p>
        </div>
    </footer>
</body>
</html>
