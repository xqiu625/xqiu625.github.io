<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bayesian Optimization - AI4Bio Learning Hub</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Lato', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #D0D6D8 100%);
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .navbar {
            background-color: #ffffff;
            border-bottom: 1px solid #e7e7e7;
            padding: 10px 0;
        }
        .navbar-nav {
            list-style-type: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .navbar-nav li {
            margin: 0 15px;
        }
        .navbar-nav a {
            color: #666666;
            text-decoration: none;
            font-weight: bold;
            font-size: 16px;
        }
        .navbar-nav a:hover {
            color: #C05540;
        }
        .home-link {
            color: #C05540 !important;
        }
        .header {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        .header h1 {
            color: #C05540;
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        .header .subtitle {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 20px;
        }
        .header .paper-ref {
            background: rgba(192, 85, 64, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.95em;
            border-left: 4px solid #C05540;
        }
        .content-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .content-section h2 {
            color: #C05540;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-left: 4px solid #F7A254;
            padding-left: 15px;
        }
        .content-section h3 {
            color: #F7A254;
            font-size: 1.4em;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        .content-section h4 {
            color: #F7C550;
            font-size: 1.2em;
            margin-top: 20px;
        }
        .content-section p {
            color: #555;
            line-height: 1.8;
            margin-bottom: 15px;
        }
        .concept-box {
            background: rgba(247, 197, 80, 0.1);
            border-left: 4px solid #F7C550;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .concept-box h3 {
            color: #F7C550;
            margin-top: 0;
        }
        .concept-box.challenge {
            background: rgba(192, 85, 64, 0.1);
            border-left-color: #C05540;
        }
        .concept-box.challenge h3 {
            color: #C05540;
        }
        .concept-box.gp {
            background: rgba(247, 162, 84, 0.1);
            border-left-color: #F7A254;
        }
        .concept-box.gp h3 {
            color: #F7A254;
        }
        .concept-box.acquisition {
            background: rgba(245, 200, 131, 0.1);
            border-left-color: #F5C883;
        }
        .concept-box.acquisition h3 {
            color: #F5C883;
        }
        .highlight-box {
            background: linear-gradient(135deg, #F7C550 0%, #F7A254 100%);
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .highlight-box strong {
            color: white;
        }
        .warning-box {
            background: rgba(247, 162, 84, 0.1);
            border: 2px solid #F7A254;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .warning-box strong {
            color: #C05540;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #F7C550 0%, #F7A254 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(247, 162, 84, 0.3);
        }
        .stat-card .number {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .stat-card .label {
            font-size: 0.9em;
            opacity: 0.95;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .comparison-table th {
            background: linear-gradient(135deg, #F7A254 0%, #C05540 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }
        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            color: #555;
        }
        .comparison-table tr:last-child td {
            border-bottom: none;
        }
        .comparison-table tr:hover {
            background: rgba(247, 162, 84, 0.05);
        }
        .comparison-table tr.highlight {
            background: rgba(245, 200, 131, 0.2);
        }
        .timeline {
            position: relative;
            padding: 20px 0;
            margin: 30px 0;
        }
        .timeline-item {
            position: relative;
            padding-left: 70px;
            margin-bottom: 30px;
        }
        .timeline-icon {
            position: absolute;
            left: 0;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #F7C550 0%, #F7A254 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            box-shadow: 0 2px 10px rgba(247, 162, 84, 0.3);
        }
        .timeline-content {
            background: rgba(247, 197, 80, 0.1);
            padding: 20px;
            border-radius: 10px;
            border-left: 3px solid #F7C550;
        }
        .timeline-content h4 {
            color: #F7A254;
            margin-top: 0;
        }
        .method-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 25px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border-top: 4px solid #F7A254;
        }
        .method-card h4 {
            color: #F7A254;
            margin-top: 0;
            font-size: 1.4em;
        }
        .algorithm-box {
            background: rgba(208, 214, 216, 0.3);
            border: 2px solid #F7A254;
            border-radius: 10px;
            padding: 25px;
            margin: 25px 0;
            font-family: 'Courier New', monospace;
        }
        .step {
            margin: 10px 0;
            padding-left: 20px;
            color: #555;
        }
        .formula {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-family: 'Times New Roman', serif;
            font-size: 1.1em;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 25px;
            border-radius: 10px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .code-block .comment {
            color: #75715e;
        }
        .code-block .keyword {
            color: #F7A254;
        }
        .code-block .string {
            color: #F5C883;
        }
        .code-block .function {
            color: #F7C550;
        }
        .pros-cons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 25px 0;
        }
        .pros, .cons {
            padding: 20px;
            border-radius: 10px;
        }
        .pros {
            background: rgba(245, 200, 131, 0.2);
            border-left: 4px solid #F5C883;
        }
        .pros h4 {
            color: #F5C883;
            margin-top: 0;
        }
        .cons {
            background: rgba(192, 85, 64, 0.1);
            border-left: 4px solid #C05540;
        }
        .cons h4 {
            color: #C05540;
            margin-top: 0;
        }
        .decision-tree {
            background: rgba(247, 197, 80, 0.1);
            padding: 30px;
            border-radius: 15px;
            margin: 25px 0;
        }
        .decision-node {
            background: white;
            border: 2px solid #F7A254;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }
        .decision-node strong {
            color: #F7A254;
        }
        .decision-arrow {
            text-align: center;
            color: #F7A254;
            font-size: 1.8em;
            margin: 10px 0;
        }
        .cta-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 40px 0;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .cta-section h3 {
            color: #C05540;
            margin-bottom: 15px;
        }
        .cta-button {
            display: inline-block;
            color: white;
            padding: 12px 30px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 0 10px;
            background: linear-gradient(135deg, #F7C550 0%, #F7A254 100%);
        }
        .cta-button:hover {
            background: linear-gradient(135deg, #F7A254 0%, #C05540 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(247, 162, 84, 0.4);
        }
        @media (max-width: 768px) {
            .header {
                padding: 25px;
            }
            .header h1 {
                font-size: 2em;
            }
            .content-section {
                padding: 25px;
            }
            .pros-cons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <ul class="navbar-nav">
                <li><a href="../index.html" class="home-link"><i class="fas fa-home"></i> Back to Learning Hub</a></li>
                <li><a href="#problem">The Problem</a></li>
                <li><a href="#concepts">Core Concepts</a></li>
                <li><a href="#implementation">Implementation</a></li>
            </ul>
        </div>
    </nav>

    <main role="main">
        <div class="container">
            <div class="header">
                <h1><i class="fas fa-chart-line"></i> Bayesian Optimization</h1>
                <p class="subtitle">Smart hyperparameter tuning for expensive black-box functions</p>
                <div class="paper-ref">
                    <strong>🎯 Key Application:</strong> Optimizing neural network hyperparameters with 10-100x fewer evaluations than grid search or random search
                </div>
            </div>

            <!-- The Problem -->
            <div class="content-section" id="problem">
                <h2><i class="fas fa-exclamation-triangle"></i> The Problem</h2>
                
                <div class="concept-box challenge">
                    <h3>When Do You Need Bayesian Optimization?</h3>
                    <p><strong>Core Challenge:</strong> You need to optimize a function f(x) that is:</p>
                    <ul>
                        <li><strong>Expensive to evaluate</strong> - Each evaluation takes minutes to hours (training a deep learning model)</li>
                        <li><strong>Black-box</strong> - No gradient information available</li>
                        <li><strong>Noisy</strong> - Evaluations may have stochastic variability</li>
                        <li><strong>High-dimensional</strong> - Multiple parameters to tune simultaneously</li>
                    </ul>
                </div>

                <h3>Concrete Example: Neural Network Hyperparameter Tuning</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="number">Learning Rate</div>
                        <div class="label">0.0001 to 0.1 (continuous)</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">Batch Size</div>
                        <div class="label">16, 32, 64, 128 (discrete)</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">Dropout Rate</div>
                        <div class="label">0.0 to 0.5 (continuous)</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">Hidden Layers</div>
                        <div class="label">2, 3, 4, 5 (discrete)</div>
                    </div>
                </div>

                <div class="warning-box">
                    <strong><i class="fas fa-exclamation-circle"></i> The Cost Problem:</strong> 
                    If you have 4 hyperparameters with 10 values each, grid search requires 10<sup>4</sup> = 10,000 evaluations. If each evaluation takes 1 hour, that's 417 days of computation! Bayesian optimization can find near-optimal settings in 50-200 evaluations.
                </div>

                <h3>Why Traditional Methods Fail</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Strategy</th>
                            <th>Evaluations Needed</th>
                            <th>Problem</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Grid Search</strong></td>
                            <td>Try all combinations</td>
                            <td>n<sup>d</sup> (exponential)</td>
                            <td>Curse of dimensionality</td>
                        </tr>
                        <tr>
                            <td><strong>Random Search</strong></td>
                            <td>Sample randomly</td>
                            <td>100-1000+</td>
                            <td>Ignores previous results</td>
                        </tr>
                        <tr>
                            <td><strong>Manual Tuning</strong></td>
                            <td>Human intuition</td>
                            <td>20-100</td>
                            <td>Slow, biased, not reproducible</td>
                        </tr>
                        <tr class="highlight">
                            <td><strong>Bayesian Optimization</strong></td>
                            <td>Learn from evaluations</td>
                            <td><strong>50-200</strong></td>
                            <td><strong>Best balance of efficiency & performance</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Core Concepts -->
            <div class="content-section" id="concepts">
                <h2><i class="fas fa-lightbulb"></i> Core Concepts</h2>
                
                <div class="concept-box">
                    <h3>The Big Picture</h3>
                    <p>Bayesian Optimization is a two-part iterative algorithm:</p>
                    <ol>
                        <li><strong>Surrogate Model (Gaussian Process):</strong> Build a probabilistic model of the objective function using past evaluations</li>
                        <li><strong>Acquisition Function:</strong> Use the surrogate to decide where to evaluate next, balancing exploration vs. exploitation</li>
                    </ol>
                </div>

                <h3>The Algorithm Loop</h3>
                <div class="algorithm-box">
                    <strong style="color: #C05540;">Algorithm: Bayesian Optimization</strong><br><br>
                    <div class="step">1. Initialize with random evaluations: D = {(x₁, y₁), ..., (x_n, y_n)}</div>
                    <div class="step">2. <strong>Repeat</strong> until budget exhausted:</div>
                    <div class="step" style="padding-left: 40px;">a. Fit Gaussian Process to current data D</div>
                    <div class="step" style="padding-left: 40px;">b. Optimize acquisition function to find x_next</div>
                    <div class="step" style="padding-left: 40px;">c. Evaluate y_next = f(x_next)</div>
                    <div class="step" style="padding-left: 40px;">d. Update D = D ∪ {(x_next, y_next)}</div>
                    <div class="step">3. <strong>Return</strong> x* = argmax y in D</div>
                </div>

                <h3>The Process</h3>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-icon">1</div>
                        <div class="timeline-content">
                            <h4>Random Initialization (5-10 evaluations)</h4>
                            <p>Sample initial points uniformly to get a rough sense of the landscape</p>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-icon">2</div>
                        <div class="timeline-content">
                            <h4>Build Surrogate Model</h4>
                            <p>Fit a Gaussian Process that predicts both mean and uncertainty for any point</p>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-icon">3</div>
                        <div class="timeline-content">
                            <h4>Acquisition Function Optimization</h4>
                            <p>Find the point that maximizes expected improvement (or another acquisition function)</p>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-icon">4</div>
                        <div class="timeline-content">
                            <h4>Evaluate & Update</h4>
                            <p>Train model at selected point, add result to dataset, repeat until convergence</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gaussian Processes -->
            <div class="content-section">
                <h2><i class="fas fa-wave-square"></i> Component 1: Gaussian Processes</h2>
                
                <div class="concept-box gp">
                    <h3>What is a Gaussian Process?</h3>
                    <p>A Gaussian Process (GP) is a distribution over functions. Think of it as "infinite-dimensional Gaussian distribution" where any finite set of points follows a multivariate Gaussian.</p>
                </div>

                <h3>Key Properties</h3>
                <div class="highlight-box">
                    <strong><i class="fas fa-check-circle"></i> Why GPs are Perfect for Bayesian Optimization:</strong>
                    <ul>
                        <li><strong>Predictive mean:</strong> Best guess of function value at any point</li>
                        <li><strong>Predictive variance:</strong> Uncertainty estimate (confidence intervals)</li>
                        <li><strong>Interpolation:</strong> Passes through observed data exactly (zero uncertainty at training points)</li>
                        <li><strong>Smooth:</strong> Assumes nearby points have similar values (controlled by kernel)</li>
                    </ul>
                </div>

                <h3>Mathematical Formulation</h3>
                <div class="formula">
                    f(x) ~ GP(m(x), k(x, x'))<br><br>
                    <strong>Mean function:</strong> m(x) = E[f(x)]<br>
                    <strong>Kernel function:</strong> k(x, x') = Cov[f(x), f(x')]
                </div>

                <h3>Common Kernels</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Kernel</th>
                            <th>Use Case</th>
                            <th>Smoothness</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>RBF (Squared Exponential)</strong></td>
                            <td>Default choice, smooth functions</td>
                            <td>Infinitely differentiable</td>
                        </tr>
                        <tr>
                            <td><strong>Matérn 5/2</strong></td>
                            <td>Realistic, less smooth than RBF</td>
                            <td>Twice differentiable</td>
                        </tr>
                        <tr>
                            <td><strong>Matérn 3/2</strong></td>
                            <td>Rougher functions</td>
                            <td>Once differentiable</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Implementation Example</h3>
                <div class="code-block">
<span class="keyword">from</span> sklearn.gaussian_process <span class="keyword">import</span> GaussianProcessRegressor
<span class="keyword">from</span> sklearn.gaussian_process.kernels <span class="keyword">import</span> Matern, ConstantKernel
<span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># Define kernel: signal variance * Matérn 5/2</span>
kernel = ConstantKernel(1.0) * Matern(length_scale=1.0, nu=2.5)

<span class="comment"># Create GP</span>
gp = GaussianProcessRegressor(
    kernel=kernel,
    alpha=1e-6,  <span class="comment"># noise variance</span>
    n_restarts_optimizer=10
)

<span class="comment"># Fit to observed data</span>
X_observed = np.array([[0.1], [0.5], [0.9]])
y_observed = np.array([0.3, 0.8, 0.2])
gp.fit(X_observed, y_observed)

<span class="comment"># Predict at new points (with uncertainty)</span>
X_test = np.linspace(0, 1, 100).reshape(-1, 1)
y_mean, y_std = gp.predict(X_test, return_std=<span class="keyword">True</span>)
                </div>
            </div>

            <!-- Acquisition Functions -->
            <div class="content-section">
                <h2><i class="fas fa-bullseye"></i> Component 2: Acquisition Functions</h2>
                
                <div class="concept-box acquisition">
                    <h3>The Exploration-Exploitation Trade-off</h3>
                    <p><strong>Exploitation:</strong> Sample where the GP predicts high values (exploit what you know)</p>
                    <p><strong>Exploration:</strong> Sample where the GP has high uncertainty (explore the unknown)</p>
                    <p><strong>Goal:</strong> Balance both to efficiently find the global optimum</p>
                </div>

                <h3>Expected Improvement (EI)</h3>
                <div class="method-card">
                    <h4>Most Popular Acquisition Function</h4>
                    <div class="formula">
                        EI(x) = E[max(f(x) - f(x⁺), 0)]<br><br>
                        = (μ(x) - f(x⁺) - ξ)Φ(Z) + σ(x)φ(Z)
                    </div>
                    <p><strong>f(x⁺):</strong> Best observed value so far (incumbent)</p>
                    <p><strong>ξ:</strong> Exploration parameter (typically 0.01)</p>
                    <p><strong>Φ, φ:</strong> CDF and PDF of standard normal</p>
                </div>

                <div class="pros-cons">
                    <div class="pros">
                        <h4><i class="fas fa-check-circle"></i> Pros of EI</h4>
                        <ul>
                            <li>Closed-form solution (fast to compute)</li>
                            <li>Natural exploration-exploitation balance</li>
                            <li>Zero at observed points (encourages exploration)</li>
                            <li>Most widely used and well-tested</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h4><i class="fas fa-times-circle"></i> Cons of EI</h4>
                        <ul>
                            <li>Can be overly exploitative</li>
                            <li>May get stuck in local optima</li>
                            <li>Sensitive to ξ parameter</li>
                        </ul>
                    </div>
                </div>

                <h3>Other Acquisition Functions</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Function</th>
                            <th>Behavior</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Upper Confidence Bound (UCB)</strong></td>
                            <td>More exploration</td>
                            <td>When you want guaranteed convergence</td>
                        </tr>
                        <tr>
                            <td><strong>Probability of Improvement (PI)</strong></td>
                            <td>More exploitation</td>
                            <td>When near-optimal is good enough</td>
                        </tr>
                        <tr>
                            <td><strong>Knowledge Gradient (KG)</strong></td>
                            <td>Myopic optimal</td>
                            <td>Finite budget optimization</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Applications -->
            <div class="content-section" id="implementation">
                <h2><i class="fas fa-dna"></i> Applications in Computational Biology</h2>
                
                <div class="method-card">
                    <h4>1. Neural Network Hyperparameter Tuning</h4>
                    <p><strong>Task:</strong> Find optimal hyperparameters for scVI, scGPT, or other single-cell models</p>
                    <p><strong>Parameters to optimize:</strong></p>
                    <ul>
                        <li>Learning rate (log scale: 1e-5 to 1e-2)</li>
                        <li>Latent dimension (10 to 100)</li>
                        <li>Number of hidden layers (1 to 5)</li>
                        <li>Dropout rate (0.0 to 0.5)</li>
                    </ul>
                    <p><strong>Typical results:</strong> 50 evaluations vs. 500+ for random search</p>
                </div>

                <div class="method-card">
                    <h4>2. Protein Structure Prediction Refinement</h4>
                    <p><strong>Task:</strong> Optimize AlphaFold2 or ESMFold parameters for a specific protein family</p>
                    <p><strong>Parameters:</strong> MSA depth, template selection threshold, recycle iterations</p>
                    <p><strong>Objective:</strong> Maximize pLDDT score or minimize RMSD</p>
                </div>

                <div class="method-card">
                    <h4>3. Drug Discovery: Molecular Property Optimization</h4>
                    <p><strong>Task:</strong> Find molecules with desired properties using generative models</p>
                    <p><strong>Constraint:</strong> Each evaluation requires expensive molecular dynamics simulation</p>
                </div>

                <h3>Real-World Case Study: scVI Optimization</h3>
                <div class="concept-box">
                    <p><strong>Dataset:</strong> 50,000 single-cell RNA-seq profiles, 20 cell types</p>
                    <p><strong>Results:</strong></p>
                    <ul>
                        <li>Random search (200 evals): Best accuracy = 87.3%</li>
                        <li>Bayesian optimization (50 evals): Best accuracy = 91.2%</li>
                        <li><strong>4x fewer evaluations, 4.5% better performance</strong></li>
                    </ul>
                </div>
            </div>

            <!-- Practical Guide -->
            <div class="content-section">
                <h2><i class="fas fa-wrench"></i> Practical Considerations</h2>
                
                <h3>When to Use Bayesian Optimization</h3>
                <div class="decision-tree">
                    <div class="decision-node">
                        <strong>Q: How expensive is each evaluation?</strong>
                    </div>
                    <div class="decision-arrow">↓</div>
                    
                    <div class="decision-node">
                        <strong>Cheap (< 1 second)</strong><br>
                        ❌ Use grid search or random search
                    </div>
                    
                    <div class="decision-node">
                        <strong>Moderate (1 second to 1 minute)</strong><br>
                        ⚠️ Consider if budget < 100 evaluations
                    </div>
                    
                    <div class="decision-node">
                        <strong>Expensive (> 1 minute)</strong><br>
                        ✅ Use Bayesian optimization
                    </div>
                </div>

                <h3>Software Libraries</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Library</th>
                            <th>Best For</th>
                            <th>Pros</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>scikit-optimize</strong></td>
                            <td>Getting started, prototyping</td>
                            <td>Easy to use, lightweight</td>
                        </tr>
                        <tr>
                            <td><strong>BoTorch</strong></td>
                            <td>State-of-the-art methods</td>
                            <td>GPU support, scalable, active development</td>
                        </tr>
                        <tr class="highlight">
                            <td><strong>Optuna</strong></td>
                            <td>ML pipelines, production</td>
                            <td>Easy integration, TPE algorithm, pruning</td>
                        </tr>
                        <tr>
                            <td><strong>Ax Platform</strong></td>
                            <td>Large-scale experiments</td>
                            <td>Multi-objective, parallel, databases</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Quick Start with Optuna</h3>
                <div class="code-block">
<span class="keyword">import</span> optuna

<span class="keyword">def</span> <span class="function">objective</span>(trial):
    <span class="comment"># Sample hyperparameters</span>
    lr = trial.suggest_float(<span class="string">'learning_rate'</span>, 1e-6, 1e-1, log=<span class="keyword">True</span>)
    latent_dim = trial.suggest_int(<span class="string">'latent_dim'</span>, 10, 100)
    dropout = trial.suggest_float(<span class="string">'dropout'</span>, 0.0, 0.5)
    
    <span class="comment"># Train model</span>
    accuracy = train_model(lr, latent_dim, dropout)
    
    <span class="keyword">return</span> accuracy

<span class="comment"># Create study and optimize</span>
study = optuna.create_study(
    direction=<span class="string">'maximize'</span>,
    sampler=optuna.samplers.TPESampler()
)
study.optimize(objective, n_trials=50)

<span class="keyword">print</span>(<span class="string">f"Best params: {study.best_params}"</span>)
<span class="keyword">print</span>(<span class="string">f"Best score: {study.best_value}"</span>)
                </div>
            </div>

            <div class="cta-section">
                <h3>📚 Continue Learning</h3>
                <p>Explore more machine learning concepts and optimization techniques</p>
                <a href="../index.html" class="cta-button">
                    <i class="fas fa-arrow-left"></i> Back to Learning Hub
                </a>
            </div>
        </div>
    </main>

    <footer>
        <div class="container" style="text-align: center; margin-top: 40px; color: #666; padding-bottom: 30px;">
            <p>Part of the <a href="../index.html" style="color: #C05540; text-decoration: none; font-weight: bold;">AI4Bio Learning Hub</a> by Xinru Qiu</p>
            <p style="font-size: 0.9em; margin-top: 10px;">
                <a href="https://github.com/xqiu625" style="color: #666; margin: 0 10px;"><i class="fab fa-github"></i> GitHub</a> | 
                <a href="https://www.linkedin.com/in/xinru-qiu" style="color: #666; margin: 0 10px;"><i class="fab fa-linkedin"></i> LinkedIn</a> | 
                <a href="mailto:xinru.reina.qiu@gmail.com" style="color: #666; margin: 0 10px;"><i class="fas fa-envelope"></i> Email</a>
            </p>
        </div>
    </footer>
</body>
</html>
