<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Batch Integration Evaluation Metrics - AI4Bio Learning Hub</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Lato', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #D0D6D8 100%);
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .navbar {
            background-color: #ffffff;
            border-bottom: 1px solid #e7e7e7;
            padding: 10px 0;
        }
        .navbar-nav {
            list-style-type: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .navbar-nav li {
            margin: 0 15px;
        }
        .navbar-nav a {
            color: #666666;
            text-decoration: none;
            font-weight: bold;
            font-size: 16px;
        }
        .navbar-nav a:hover {
            color: #C05540;
        }
        .home-link {
            color: #C05540 !important;
        }
        .header {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        .header h1 {
            color: #C05540;
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        .header .subtitle {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 20px;
        }
        .header .paper-ref {
            background: rgba(192, 85, 64, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.95em;
            border-left: 4px solid #C05540;
        }
        .content-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .content-section h2 {
            color: #C05540;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-left: 4px solid #F7A254;
            padding-left: 15px;
        }
        .content-section h3 {
            color: #F7A254;
            font-size: 1.4em;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        .content-section p {
            color: #555;
            line-height: 1.8;
            margin-bottom: 15px;
        }
        .concept-box {
            background: rgba(247, 197, 80, 0.1);
            border-left: 4px solid #F7C550;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .concept-box h3 {
            color: #F7C550;
            margin-top: 0;
        }
        .concept-box.batch {
            background: rgba(192, 85, 64, 0.1);
            border-left-color: #C05540;
        }
        .concept-box.batch h3,
        .concept-box.batch h4 {
            color: #C05540;
        }
        .concept-box.bio {
            background: rgba(245, 200, 131, 0.1);
            border-left-color: #F5C883;
        }
        .concept-box.bio h3,
        .concept-box.bio h4 {
            color: #F5C883;
        }
        .highlight-box {
            background: linear-gradient(135deg, #F7C550 0%, #F7A254 100%);
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .highlight-box strong {
            color: white;
        }
        .warning-box {
            background: rgba(247, 162, 84, 0.1);
            border: 2px solid #F7A254;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .warning-box strong {
            color: #C05540;
        }
        .tradeoff-diagram {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 30px;
            background: rgba(208, 214, 216, 0.3);
            border-radius: 15px;
            margin: 30px 0;
        }
        .tradeoff-box {
            text-align: center;
            padding: 25px;
            border-radius: 15px;
            flex: 1;
            margin: 0 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .tradeoff-box.batch {
            background: linear-gradient(135deg, #C05540 0%, #a04532 100%);
            color: white;
        }
        .tradeoff-box.bio {
            background: linear-gradient(135deg, #F5C883 0%, #F7C550 100%);
            color: white;
        }
        .tradeoff-box h4 {
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        .tradeoff-arrow {
            font-size: 2.5em;
            color: #F7A254;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #F7C550 0%, #F7A254 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(247, 162, 84, 0.3);
        }
        .stat-card.batch {
            background: linear-gradient(135deg, #C05540 0%, #a04532 100%);
        }
        .stat-card.bio {
            background: linear-gradient(135deg, #F5C883 0%, #F7C550 100%);
        }
        .stat-card .number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .stat-card .label {
            font-size: 0.95em;
            opacity: 0.95;
        }
        .metric-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 25px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border-top: 4px solid #F7A254;
        }
        .metric-card h4 {
            color: #F7A254;
            margin-top: 0;
            font-size: 1.4em;
            margin-bottom: 20px;
        }
        .metric-formula {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            text-align: center;
            font-size: 1.1em;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .visual-scale {
            display: flex;
            align-items: center;
            margin: 20px 0;
            padding: 15px;
            background: rgba(247, 197, 80, 0.1);
            border-radius: 10px;
        }
        .scale-bar {
            flex-grow: 1;
            height: 35px;
            background: linear-gradient(90deg, #C05540 0%, #F7A254 50%, #F5C883 100%);
            border-radius: 8px;
            margin: 0 20px;
            position: relative;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .scale-marker {
            position: absolute;
            top: -10px;
            width: 3px;
            height: 55px;
            background: #2d2d2d;
        }
        .scale-label {
            font-weight: bold;
            min-width: 70px;
            color: #555;
        }
        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .score-item {
            padding: 20px;
            background: white;
            border-radius: 10px;
            border-left: 4px solid #F7A254;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .score-item.good {
            border-left-color: #F5C883;
            background: rgba(245, 200, 131, 0.1);
        }
        .score-item.bad {
            border-left-color: #C05540;
            background: rgba(192, 85, 64, 0.1);
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .comparison-table th {
            background: linear-gradient(135deg, #F7A254 0%, #C05540 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }
        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            color: #555;
        }
        .comparison-table tr:last-child td {
            border-bottom: none;
        }
        .comparison-table tr:hover {
            background: rgba(247, 162, 84, 0.05);
        }
        .comparison-table tr.highlight {
            background: rgba(245, 200, 131, 0.2);
        }
        .cta-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 40px 0;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .cta-section h3 {
            color: #C05540;
            margin-bottom: 15px;
        }
        .cta-button {
            display: inline-block;
            color: white;
            padding: 12px 30px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 0 10px;
        }
        .cta-button-primary {
            background: linear-gradient(135deg, #F7C550 0%, #F7A254 100%);
        }
        .cta-button-primary:hover {
            background: linear-gradient(135deg, #F7A254 0%, #C05540 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(247, 162, 84, 0.4);
        }
        .key-points {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .key-point {
            border-left: 4px solid;
            padding: 20px;
            border-radius: 8px;
        }
        .key-point:nth-child(1) {
            background: rgba(245, 200, 131, 0.1);
            border-left-color: #F5C883;
        }
        .key-point:nth-child(2) {
            background: rgba(247, 197, 80, 0.1);
            border-left-color: #F7C550;
        }
        .key-point:nth-child(3) {
            background: rgba(247, 162, 84, 0.1);
            border-left-color: #F7A254;
        }
        .key-point:nth-child(4) {
            background: rgba(192, 85, 64, 0.1);
            border-left-color: #C05540;
        }
        .key-point h4 {
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        .key-point:nth-child(1) h4 {
            color: #F5C883;
        }
        .key-point:nth-child(2) h4 {
            color: #F7C550;
        }
        .key-point:nth-child(3) h4 {
            color: #F7A254;
        }
        .key-point:nth-child(4) h4 {
            color: #C05540;
        }
        .key-point p {
            color: #666;
            font-size: 0.95em;
            margin: 0;
        }
        @media (max-width: 768px) {
            .header {
                padding: 25px;
            }
            .header h1 {
                font-size: 2em;
            }
            .content-section {
                padding: 25px;
            }
            .tradeoff-diagram {
                flex-direction: column;
            }
            .tradeoff-arrow {
                transform: rotate(90deg);
                margin: 15px 0;
            }
            .score-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <ul class="navbar-nav">
                <li><a href="../index.html" class="home-link"><i class="fas fa-home"></i> Back to Learning Hub</a></li>
                <li><a href="#problem">The Problem</a></li>
                <li><a href="#metrics">Metrics</a></li>
                <li><a href="#interpretation">Interpretation</a></li>
            </ul>
        </div>
    </nav>

    <main role="main">
        <div class="container">
            <div class="header">
                <h1><i class="fas fa-chart-line"></i> Batch Integration Evaluation Metrics</h1>
                <p class="subtitle">Balancing batch removal with biological signal preservation</p>
                <div class="paper-ref">
                    <strong>📚 Standard Framework:</strong> SCIB (Luecken et al. 2022) provides comprehensive benchmarking metrics used by SATURN and most integration methods
                </div>
            </div>

            <!-- The Problem -->
            <div class="content-section" id="problem">
                <h2><i class="fas fa-question-circle"></i> The Batch Integration Challenge</h2>
                
                <div class="concept-box">
                    <h3>What is Batch Integration?</h3>
                    <p><strong>Batch integration</strong> (also called batch correction, data harmonization) is the process of combining multiple datasets while removing technical variation but preserving biological variation.</p>
                    
                    <p><strong>Sources of batch effects:</strong></p>
                    <ul>
                        <li><strong>Technical:</strong> Different sequencing platforms, labs, protocols, reagent batches</li>
                        <li><strong>Biological:</strong> Different species, tissues, time points, conditions</li>
                        <li><strong>Computational:</strong> Different preprocessing pipelines, normalization methods</li>
                    </ul>
                </div>

                <h3>The Central Tension</h3>
                <div class="tradeoff-diagram">
                    <div class="tradeoff-box batch">
                        <h4><i class="fas fa-eraser"></i> Remove Batch Effects</h4>
                        <p>Mix cells from different datasets</p>
                        <p><strong>Goal:</strong> Technical variation → 0</p>
                    </div>
                    
                    <div class="tradeoff-arrow">⚖️</div>
                    
                    <div class="tradeoff-box bio">
                        <h4><i class="fas fa-dna"></i> Preserve Biology</h4>
                        <p>Keep cell type structure intact</p>
                        <p><strong>Goal:</strong> Biological signal → 100%</p>
                    </div>
                </div>

                <div class="warning-box">
                    <strong><i class="fas fa-exclamation-triangle"></i> The Evaluation Problem:</strong> 
                    How do you know if your integration worked? You need metrics that measure BOTH batch mixing AND biological conservation. Traditional metrics only measure one or the other.
                </div>

                <h3>Why Visual Inspection Isn't Enough</h3>
                <div class="concept-box">
                    <p><strong>Common mistake:</strong> "The UMAP looks mixed, so integration worked!"</p>
                    <p><strong>Problem:</strong> UMAP can be deceiving. Cells might mix across batches but also lose biological structure.</p>
                    
                    <p><strong>Example scenarios:</strong></p>
                    <ul>
                        <li><strong>Over-integration:</strong> All cells collapse to one blob (perfect mixing, no biology)</li>
                        <li><strong>Under-integration:</strong> Cells stay in separate batch-specific clusters (perfect biology, no mixing)</li>
                        <li><strong>Successful integration:</strong> Cells mix by batch but cluster by cell type</li>
                    </ul>
                </div>
            </div>

            <!-- The Framework -->
            <div class="content-section">
                <h2><i class="fas fa-balance-scale"></i> The SCIB Framework</h2>
                
                <div class="concept-box">
                    <h3>Two-Category Metric System</h3>
                    <p>The SCIB (Single-Cell Integration Benchmark) framework evaluates integration across two complementary dimensions:</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card batch">
                        <div class="number">40%</div>
                        <div class="label">Batch Removal Metrics</div>
                    </div>
                    <div class="stat-card bio">
                        <div class="number">60%</div>
                        <div class="label">Bio-Conservation Metrics</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">Overall</div>
                        <div class="label">Weighted Average Score</div>
                    </div>
                </div>

                <div class="metric-formula">
                    Overall Score = 0.6 × Bio Score + 0.4 × Batch Score
                </div>

                <div class="highlight-box">
                    <strong><i class="fas fa-lightbulb"></i> Why 60-40 Weighting?</strong> 
                    Preserving biological signal is slightly more important than removing batch effects. You can always analyze batches separately, but you can't recover lost biological structure.
                </div>
            </div>

            <!-- Batch Removal Metrics -->
            <div class="content-section" id="metrics">
                <h2><i class="fas fa-eraser"></i> Batch Removal Metrics (40%)</h2>
                
                <p><strong>Goal:</strong> Measure how well technical variation is removed—do cells from different batches mix together?</p>

                <div class="metric-card">
                    <h4>1. Average Silhouette Width (ASW) - Batch</h4>
                    
                    <div class="concept-box batch">
                        <p><strong>What it measures:</strong> How well-separated batches are in embedding space. Lower is better (want batches mixed).</p>
                        
                        <p><strong>Intuition:</strong> For each cell, compare its distance to cells in the same batch vs. cells in other batches.</p>
                        
                        <p><strong>Formula concept:</strong></p>
                        <ul>
                            <li>a = average distance to cells in same batch</li>
                            <li>b = average distance to cells in nearest other batch</li>
                            <li>Silhouette = (b - a) / max(a, b)</li>
                        </ul>
                    </div>

                    <div class="visual-scale">
                        <span class="scale-label">Worse</span>
                        <div class="scale-bar">
                            <div class="scale-marker" style="left: 0%;"></div>
                            <div class="scale-marker" style="left: 50%;"></div>
                            <div class="scale-marker" style="left: 100%;"></div>
                        </div>
                        <span class="scale-label">Better</span>
                    </div>
                    <p style="text-align: center; color: #666; font-size: 0.9em;">
                        <strong>1.0:</strong> Batches perfectly separated | <strong>0.0:</strong> Random mixing | <strong>-1.0:</strong> Perfect integration
                    </p>

                    <div class="score-grid">
                        <div class="score-item bad">
                            <strong>ASW<sub>batch</sub> = 0.8</strong><br>
                            <small>Batches are very separated (bad integration)</small>
                        </div>
                        <div class="score-item good">
                            <strong>ASW<sub>batch</sub> = -0.2</strong><br>
                            <small>Batches are well-mixed (good integration)</small>
                        </div>
                    </div>

                    <div class="warning-box">
                        <strong>Limitation:</strong> ASW can be low (good) if you completely scramble all biological structure. Must check with bio-conservation metrics!
                    </div>
                </div>

                <div class="metric-card">
                    <h4>2. Graph Connectivity</h4>
                    
                    <div class="concept-box batch">
                        <p><strong>What it measures:</strong> Whether cells from different batches are neighbors in the k-nearest neighbor (kNN) graph.</p>
                        
                        <p><strong>Process:</strong></p>
                        <ol>
                            <li>Build kNN graph in integrated embedding space (k=15 typical)</li>
                            <li>For each cell type, check if all batches are in same connected component</li>
                            <li>Score = fraction of cell types where all batches are connected</li>
                        </ol>
                    </div>

                    <div class="visual-scale">
                        <span class="scale-label">Worse</span>
                        <div class="scale-bar">
                            <div class="scale-marker" style="left: 0%;"></div>
                            <div class="scale-marker" style="left: 50%;"></div>
                            <div class="scale-marker" style="left: 100%;"></div>
                        </div>
                        <span class="scale-label">Better</span>
                    </div>

                    <div class="score-grid">
                        <div class="score-item bad">
                            <strong>Connectivity = 0.3</strong><br>
                            <small>Only 30% of cell types connected across batches</small>
                        </div>
                        <div class="score-item good">
                            <strong>Connectivity = 0.95</strong><br>
                            <small>95% of cell types connected across batches</small>
                        </div>
                    </div>
                </div>

                <h3>Computing Average Batch Score</h3>
                <div class="metric-formula">
                    Batch Score = (ASW<sub>batch</sub> + Graph Connectivity) / 2
                </div>
            </div>

            <!-- Bio-Conservation Metrics -->
            <div class="content-section">
                <h2><i class="fas fa-dna"></i> Bio-Conservation Metrics (60%)</h2>
                
                <p><strong>Goal:</strong> Measure how well biological structure (cell types, trajectories) is preserved after integration.</p>

                <div class="metric-card">
                    <h4>1. Normalized Mutual Information (NMI) - Cell Type</h4>
                    
                    <div class="concept-box bio">
                        <p><strong>What it measures:</strong> How much knowing a cell's cluster assignment tells you about its true cell type.</p>
                        
                        <p><strong>Key properties:</strong></p>
                        <ul>
                            <li><strong>0.0:</strong> Cluster labels tell you nothing about cell type</li>
                            <li><strong>1.0:</strong> Cluster labels perfectly predict cell type</li>
                            <li><strong>Normalized:</strong> Accounts for different numbers of clusters vs. cell types</li>
                        </ul>
                    </div>

                    <div class="score-grid">
                        <div class="score-item bad">
                            <strong>NMI = 0.3</strong><br>
                            <small>Clusters barely reflect cell type identity</small>
                        </div>
                        <div class="score-item good">
                            <strong>NMI = 0.85</strong><br>
                            <small>Clusters strongly correspond to cell types</small>
                        </div>
                    </div>
                </div>

                <div class="metric-card">
                    <h4>2. Adjusted Rand Index (ARI) - Cell Type</h4>
                    
                    <div class="concept-box bio">
                        <p><strong>What it measures:</strong> Agreement between cluster assignments and true cell type labels, adjusted for chance.</p>
                        
                        <p><strong>Key properties:</strong></p>
                        <ul>
                            <li><strong>0.0:</strong> Random clustering (no better than chance)</li>
                            <li><strong>1.0:</strong> Perfect clustering</li>
                            <li><strong>Adjusted for chance:</strong> Accounts for random agreement</li>
                        </ul>
                    </div>
                </div>

                <div class="metric-card">
                    <h4>3. Average Silhouette Width (ASW) - Cell Type</h4>
                    
                    <div class="concept-box bio">
                        <p><strong>What it measures:</strong> How well-separated cell types are. Higher is better (want cell types separated).</p>
                        
                        <div class="warning-box">
                            <strong>Note:</strong> ASW-Batch and ASW-Cell Type measure opposite things! For batch, lower is better. For cell type, higher is better.
                        </div>
                    </div>
                </div>

                <h3>Computing Average Bio Score</h3>
                <div class="metric-formula">
                    Bio Score = (NMI + ARI + ASW<sub>cell type</sub>) / 3
                </div>
            </div>

            <!-- Example -->
            <div class="content-section">
                <h2><i class="fas fa-star"></i> Example: SATURN Performance</h2>
                
                <div class="stats-grid">
                    <div class="stat-card bio">
                        <div class="number">82%</div>
                        <div class="label">Bio-Conservation Score</div>
                    </div>
                    <div class="stat-card batch">
                        <div class="number">83%</div>
                        <div class="label">Batch Removal Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">82.4%</div>
                        <div class="label">Overall Score</div>
                    </div>
                </div>

                <div class="metric-formula">
                    Overall = 0.6 × 0.82 + 0.4 × 0.83 = 0.824
                </div>

                <div class="highlight-box">
                    <strong><i class="fas fa-check-circle"></i> Interpretation:</strong> 
                    SATURN achieves excellent performance in BOTH bio-conservation and batch removal, indicating successful integration that preserves cell type structure while mixing species.
                </div>

                <h3>Comparison with Other Methods</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Bio Score</th>
                            <th>Batch Score</th>
                            <th>Overall Score</th>
                            <th>Interpretation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="highlight">
                            <td><strong>SATURN</strong></td>
                            <td>0.82</td>
                            <td>0.83</td>
                            <td><strong>0.824</strong></td>
                            <td>Excellent balance</td>
                        </tr>
                        <tr>
                            <td>SAMap</td>
                            <td>0.48</td>
                            <td>0.59</td>
                            <td>0.524</td>
                            <td>Moderate performance</td>
                        </tr>
                        <tr>
                            <td>Harmony</td>
                            <td>0.37</td>
                            <td>0.81</td>
                            <td>0.546</td>
                            <td>Good mixing, poor bio</td>
                        </tr>
                        <tr>
                            <td>scVI</td>
                            <td>0.41</td>
                            <td>0.78</td>
                            <td>0.558</td>
                            <td>Good mixing, moderate bio</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Interpretation -->
            <div class="content-section" id="interpretation">
                <h2><i class="fas fa-book-open"></i> Interpretation Guide</h2>
                
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Bio Score</th>
                            <th>Batch Score</th>
                            <th>Interpretation</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="highlight">
                            <td><strong>High (>0.7)</strong></td>
                            <td><strong>High (>0.7)</strong></td>
                            <td>✅ <strong>Excellent integration</strong></td>
                            <td>Success! Use for analysis</td>
                        </tr>
                        <tr>
                            <td>High</td>
                            <td>Low (<0.5)</td>
                            <td>⚠️ <strong>Under-integration</strong></td>
                            <td>Increase batch correction</td>
                        </tr>
                        <tr>
                            <td>Low (<0.5)</td>
                            <td>High</td>
                            <td>⚠️ <strong>Over-integration</strong></td>
                            <td>Decrease batch correction</td>
                        </tr>
                        <tr>
                            <td>Low</td>
                            <td>Low</td>
                            <td>❌ <strong>Failed integration</strong></td>
                            <td>Try different method</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Best Practices -->
            <div class="content-section">
                <h2><i class="fas fa-check-square"></i> Best Practices</h2>
                
                <div class="key-points">
                    <div class="key-point">
                        <h4>Always Check Both</h4>
                        <p>Compute BOTH bio and batch metrics—don't rely on UMAP visualization alone</p>
                    </div>
                    <div class="key-point">
                        <h4>Multiple Runs</h4>
                        <p>Report mean ± std across multiple runs with different random seeds</p>
                    </div>
                    <div class="key-point">
                        <h4>Per-Cell-Type Analysis</h4>
                        <p>Check metrics for rare cell types separately—overall scores can hide poor performance</p>
                    </div>
                    <div class="key-point">
                        <h4>Validate with Biology</h4>
                        <p>Verify that known marker genes still cluster correctly after integration</p>
                    </div>
                </div>
            </div>

            <div class="cta-section">
                <h3>📚 Continue Learning</h3>
                <p>Explore related concepts in computational biology and machine learning</p>
                <a href="../index.html" class="cta-button cta-button-primary">
                    <i class="fas fa-arrow-left"></i> Back to Learning Hub
                </a>
            </div>
        </div>
    </main>

    <footer>
        <div class="container" style="text-align: center; margin-top: 40px; color: #666; padding-bottom: 30px;">
            <p>Part of the <a href="../index.html" style="color: #C05540; text-decoration: none; font-weight: bold;">AI4Bio Learning Hub</a> by Xinru Qiu</p>
            <p style="font-size: 0.9em; margin-top: 10px;">
                <a href="https://github.com/xqiu625" style="color: #666; margin: 0 10px;"><i class="fab fa-github"></i> GitHub</a> | 
                <a href="https://www.linkedin.com/in/xinru-qiu" style="color: #666; margin: 0 10px;"><i class="fab fa-linkedin"></i> LinkedIn</a> | 
                <a href="mailto:xinru.reina.qiu@gmail.com" style="color: #666; margin: 0 10px;"><i class="fas fa-envelope"></i> Email</a>
            </p>
        </div>
    </footer>
</body>
</html>
